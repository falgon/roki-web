<!DOCTYPE HTML>
<html lang="ja">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="x-ua-compatible" content="ie=edge" />
        <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
        <meta content="Roki" name="author" />
        
        <meta content="本エントリは, 元々 [P0355R5](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0355r5.html) を参考にまとめを行った記事であるが, その後 [P0355R7](http://www.open-std.org/jt" name="description" />
        <meta property="og:description" content="本エントリは, 元々 [P0355R5](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0355r5.html) を参考にまとめを行った記事であるが, その後 [P0355R7](http://www.open-std.org/jt" />
        
        <meta content="Hakyll" name="generator" />
        <meta property="twitter:card" content="summary" />
        <meta property="twitter:site" content="@roki_r7" />
        <meta property="twitter:creator" content="roki_r7" />
        <meta property="og:type" content="website" />
        
        
            <title>C++20 Calender and timezone library - roki.dev/roki.log</title>
            <meta property="og:title" content="C++20 Calender and timezone library" />
        
        <meta property="og:site_name" content="roki.dev/roki.log" />
        
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP&amp;family=Ubuntu+Mono&amp;display=swap" rel="stylesheet">

        <link rel="stylesheet" href="../../../../../style/style.css" />
        <link rel="stylesheet" href="../../../../../style/roki.log.css" />
        <link rel="shortcut icon" href="../../../../../images/avator/favicon.ico" />
        
        
        
        <script type="text/javascript" src="../../../../../js/components.js"></script>
        <script type="text/javascript">
            addEventNavBar();
            addEventModal();
        </script>
        
        <meta name="google-site-verification" content="13X5cycw11yFEsfZrhsQ0m_cSI90r7HucdErNDQ8Za8" />
        <!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-116653080-2"></script>
		<script>
  		window.dataLayer = window.dataLayer || [];
  		function gtag(){dataLayer.push(arguments);}
  		gtag('js', new Date());
  		gtag('config', 'UA-116653080-2');
		</script>
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5658861742931397" crossorigin="anonymous"></script>
        
        
        
    </head>

    <body>
        <div class="modal" id="modal-about">
            <div class="modal-background"></div>
            <div class="modal-card">
                <header class="modal-card-head">
                    <p class="modal-card-title">
                    <svg role="img" class="svg-inline--fa fa-question fa-fw mr-2" data-icon="question" data-prefix="fas" viewBox="0 0 320 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M80 160c0-35.3 28.7-64 64-64h32c35.3 0 64 28.7 64 64v3.6c0 21.8-11.1 42.1-29.4 53.8l-42.2 27.1c-25.2 16.2-40.4 44.1-40.4 74V320c0 17.7 14.3 32 32 32s32-14.3 32-32v-1.4c0-8.2 4.2-15.8 11-20.2l42.2-27.1c36.6-23.6 58.8-64.1 58.8-107.7V160c0-70.7-57.3-128-128-128H144C73.3 32 16 89.3 16 160c0 17.7 14.3 32 32 32s32-14.3 32-32zm80 320a40 40 0 1 0 0-80 40 40 0 1 0 0 80z"></path></svg>About
                    </p>
                    <button class="delete" aria-label="close"></button>
                </header>
                <section class="modal-card-body">
                    <a href="../../../../../roki.log">roki.log</a><p class="is-inline"> is a blog written about efforts and learning related to technology, mathematics, etc (Most of the content of the article is written in Japanese).</p>
                    <strong>All opinions expressed by Author on this blog is solely 
                    Author’s opinions and do not reflect the opinions of the company to 
                    which I belong.</strong>
                    For more infomation about author Roki, see 
                    <a href="../../../../../index.html">roki.dev</a>.
                </section>
            </div>
        </div>

        <nav class="navbar is-spaced" role="navigation" aria-label="main navigation">
            <div class="navbar-brand">
                <a style="background-color: transparent;" class="navbar-item title pt-5" href="../../../../../roki.log/index.html">
                    roki.log
                </a>
                <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="roki-log-navbar">
                    <span aria-hidden="true"></span>
                    <span aria-hidden="true"></span>
                    <span aria-hidden="true"></span>
                </a>
            </div>
                
            <div id="roki-log-navbar" class="navbar-menu">
                <div class="navbar-end">
                    <a class="navbar-item modal-target" data-target="modal-about">
                        <svg role="img" class="svg-inline--fa fa-question fa-fw mr-2" data-icon="question" data-prefix="fas" viewBox="0 0 320 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M80 160c0-35.3 28.7-64 64-64h32c35.3 0 64 28.7 64 64v3.6c0 21.8-11.1 42.1-29.4 53.8l-42.2 27.1c-25.2 16.2-40.4 44.1-40.4 74V320c0 17.7 14.3 32 32 32s32-14.3 32-32v-1.4c0-8.2 4.2-15.8 11-20.2l42.2-27.1c36.6-23.6 58.8-64.1 58.8-107.7V160c0-70.7-57.3-128-128-128H144C73.3 32 16 89.3 16 160c0 17.7 14.3 32 32 32s32-14.3 32-32zm80 320a40 40 0 1 0 0-80 40 40 0 1 0 0 80z"></path></svg>
                        About
                    </a>
                    <div class="navbar-item has-dropdown is-hoverable">
                        <a class="navbar-link">
                            <svg role="img" class="svg-inline--fa fa-rss mr-2" data-icon="rss" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"></path></svg>
                            Feed
                        </a>
                        <div class="navbar-dropdown">
                            <a class="navbar-item" href="../../../../../roki.log/feed/roki.log.xml">
                                <svg role="img" class="svg-inline--fa fa-rss fa-fw mr-2" data-icon="rss" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"></path></svg>
                                Atom
                            </a>
                            <a class="navbar-item" href="../../../../../roki.log/feed/roki.log-rss.xml">
                                <svg role="img" class="svg-inline--fa fa-rss fa-fw mr-2" data-icon="rss" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"></path></svg>
                                RSS
                            </a>
                            <a class="navbar-item" href="https://feedly.com/i/subscription/feed/https://roki.dev/roki.log/feed/roki.log.xml" target="_blank" rel="nofollow noopener">
                                <svg role="img" class="svg-inline--fa fa-square-rss fa-fw mr-2" data-icon="square-rss" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM96 136c0-13.3 10.7-24 24-24c137 0 248 111 248 248c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-110.5-89.5-200-200-200c-13.3 0-24-10.7-24-24zm0 96c0-13.3 10.7-24 24-24c83.9 0 152 68.1 152 152c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-57.4-46.6-104-104-104c-13.3 0-24-10.7-24-24zm0 120a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"></path></svg>
                                Feedly
                            </a>
                        </div>
                    </div>
                    <div class="navbar-item has-dropdown is-hoverable">
                        <a class="navbar-link">
                            <svg role="img" class="svg-inline--fa fa-info mr-2" data-icon="info" data-prefix="fas" viewBox="0 0 192 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M48 80a48 48 0 1 1 96 0A48 48 0 1 1 48 80zM0 224c0-17.7 14.3-32 32-32H96c17.7 0 32 14.3 32 32V448h32c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H64V256H32c-17.7 0-32-14.3-32-32z"></path></svg>
                            More
                        </a>
                        <div class="navbar-dropdown">
                            <a class="navbar-item" href="../../../../../index.html">
                                <svg role="img" class="svg-inline--fa fa-house fa-fw mr-2" data-icon="house" data-prefix="fas" viewBox="0 0 576 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"></path></svg>
                                roki.dev
                            </a>
                            <hr class="navbar-divider">
                            <a class="navbar-item" href="https://github.com/falgon/roki-web/issues/new/choose" target="_blank" rel="nofollow noopener">
                                <svg role="img" class="svg-inline--fa fa-bug fa-fw mr-2" data-icon="bug" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M256 0c53 0 96 43 96 96v3.6c0 15.7-12.7 28.4-28.4 28.4H188.4c-15.7 0-28.4-12.7-28.4-28.4V96c0-53 43-96 96-96zM41.4 105.4c12.5-12.5 32.8-12.5 45.3 0l64 64c.7 .7 1.3 1.4 1.9 2.1c14.2-7.3 30.4-11.4 47.5-11.4H312c17.1 0 33.2 4.1 47.5 11.4c.6-.7 1.2-1.4 1.9-2.1l64-64c12.5-12.5 32.8-12.5 45.3 0s12.5 32.8 0 45.3l-64 64c-.7 .7-1.4 1.3-2.1 1.9c6.2 12 10.1 25.3 11.1 39.5H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H416c0 24.6-5.5 47.8-15.4 68.6c2.2 1.3 4.2 2.9 6 4.8l64 64c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0l-63.1-63.1c-24.5 21.8-55.8 36.2-90.3 39.6V240c0-8.8-7.2-16-16-16s-16 7.2-16 16V479.2c-34.5-3.4-65.8-17.8-90.3-39.6L86.6 502.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l64-64c1.9-1.9 3.9-3.4 6-4.8C101.5 367.8 96 344.6 96 320H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H96.3c1.1-14.1 5-27.5 11.1-39.5c-.7-.6-1.4-1.2-2.1-1.9l-64-64c-12.5-12.5-12.5-32.8 0-45.3z"></path></svg>
                                Report an issue
                            </a>
                        </div>
                    </div>
                    <div class="navbar-item field">
                        <script async src="https://cse.google.com/cse.js?cx=002573853708615501531:c0ipiy0rxaw">
                        </script>
                        <div class="gcse-searchbox-only"></div>
                    </div>
                </div>
            </div>
        </nav>

        


<main class="section main" role="main">
    <article class="container">
        <div class="card mb-1 is-shadowless">
            <div class="card-content">
                <header>
                    <h2 class="title is-3">
                        <a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/index.html">C++20 Calender and timezone library</a>
                    </h2>
                    <ul>
                        <li>
                            <i class="fas fa-calendar-alt fa-fw"></i>
                            2018/03/27 01:50
                        </li>
                        
                            <li>
                                <div class="is-inline-block is-valign-middle">
                                    <svg role="img" class="svg-inline--fa fa-tags fa-fw" data-icon="tags" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M345 39.1L472.8 168.4c52.4 53 52.4 138.2 0 191.2L360.8 472.9c-9.3 9.4-24.5 9.5-33.9 .2s-9.5-24.5-.2-33.9L438.6 325.9c33.9-34.3 33.9-89.4 0-123.7L310.9 72.9c-9.3-9.4-9.2-24.6 .2-33.9s24.6-9.2 33.9 .2zM0 229.5V80C0 53.5 21.5 32 48 32H197.5c17 0 33.3 6.7 45.3 18.7l168 168c25 25 25 65.5 0 90.5L277.3 442.7c-25 25-65.5 25-90.5 0l-168-168C6.7 262.7 0 246.5 0 229.5zM144 144a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"></path></svg>
                                </div>
                                <div class="is-inline-block is-valign-middle">
                                    <div class="tags">
                                        <span class="tag is-dark"><a href="../../../../../roki.log/tags/c/index.html"><span>C++</span></a></span>
                                    </div>
                                </div>
                            </li>
                        
                    </ul>
                </header>

                
                <div class="content has-text-centered mt-5">
                <script crossorigin="anonymous" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5658861742931397"></script><ins style="display:block" data-full-width-responsive="true" data-ad-client="ca-pub-5658861742931397" data-ad-format="auto" class="adsbygoogle" data-ad-slot="9716211878"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
                </div>
                

                <section class="mt-5 content">
                    
                    <article class="message is-warning">
                        <div class="message-body">
                            <i class="fas fa-info-circle mr-1"></i>
                            この記事は, <a href="https://falgon.github.io/roki.log/" target="_blank" rel="nofollow noopener">旧ブログ</a>から移植された記事です. よって, その内容として, <a href="https://falgon.github.io/roki.log/" target="_blank" rel="nofollow noopener">旧ブログ</a>に依存した文脈が含まれている可能性があります. 予めご了承下さい.
                        </div>
                    </article>
                    
                    <p>本エントリは, 元々 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0355r5.html" target="_blank" rel="nofollow noopener">P0355R5</a> を参考にまとめを行った記事であるが, その後 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0355r7.html" target="_blank" rel="nofollow noopener">P0355R7</a> で</p>
<ul>
<li><code>sun</code>といった曜日を表すリテラルが全て<code>Sunday</code>, <code>may</code>といった月を表すリテラルが全て<code>May</code>といった形式に変更され, またこれらと<code>std::chrono::last_spec</code>型の<code>last</code><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>が<code>std::literals::chrono_literals</code>名前空間下から<code>std::chrono</code>名前空間下に移動された.</li>
<li><code>system_clock::to_time_t</code>と<code>system_clock::from_time_t</code>を Deprecated としていたが, Deprecated でなくなった.</li>
</ul>
<p>といった他に, 細かい文面の改修や, <code>constexpr</code>がつけられるなどの変更が加えられたため, 本エントリにおいても, それに従い該当箇所を改変している (差分を示すことも考えたが, ただ見難くなるように感じたため, そのようなことはしなかった). これらの変更には対応したつもりだが, 細かい厳密な記述に関しては, やはり P0355 の最新リビジョンを追って確かめてほしい(そして, 間違った箇所があれば指摘くださると嬉しい).</p>
<h2 id="要旨">要旨</h2>
<p>先週, 米国フロリダ州ジャクソンビルで ISO C++ 委員会によって, C++技術仕様(TS, 実験的機能ブランチ) と次の国際標準(IS) C++20 に関する作業が行われた. 同会議で <a href="https://www.reddit.com/r/cpp/comments/854mu9/2018_jacksonville_iso_c_committee_reddit_trip/" target="_blank" rel="nofollow noopener">Reddit で紹介されているように</a>, C++20 にいくつかの機能が追加された. そのうちの 1 つである, <a href="https://wg21.link/P0355" target="_blank" rel="nofollow noopener">Calender and timezone library</a> に関する新機能, 概要のメモ.</p>
<ul>
<li>全機能の網羅性を主軸としたエントリではない(が, 独断と偏見により重要に感じた内容は結果的に網羅してしまっている部分もある)ため注意</li>
<li>以下, 特に断らない限り, 全てのコード片において<code>using namespace std::chrono;</code>, <code>using namespace std::chrono_literals;</code>がされているとする.</li>
<li>以下, 特に断らない限り, 各コードブロック以外で言及される<code>内容</code>といった記述については, 名前空間 <code>std::chrono</code>を省略する.</li>
</ul>
<!--more-->
<h2 id="設計">設計</h2>
<p>以下の内容が追加される.</p>
<ul>
<li><code>&lt;chrono&gt;</code>に対するカレンダーおよびタイムゾーンライブラリをサポートするための最小限の拡張</li>
<li>Proleptic Gregorian calendar(civil calendar)</li>
<li><a href="http://www.iana.org/time-zones" target="_blank" rel="nofollow noopener">IANA Time Zone Database</a> を基にしたタイムゾーンライブラリ</li>
<li>分数秒, タイムゾーンの略語, UTC オフセットの完全サポートおよび<code>strftime</code>のようなフォーマッティング機能</li>
<li><a href="http://www.iana.org/time-zones" target="_blank" rel="nofollow noopener">IANA Time Zone Database</a> でサポートされている, 閏秒を計算するための複数のクロック</li>
</ul>
<h3 id="カレンダー">カレンダー</h3>
<p>本ライブラリ機能によって, 例えば 2016 年を次のように表現することができる.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb1-1" aria-hidden="true"></a><span class="kw">auto</span> y = <span class="bu">std::</span>chrono<span class="bu">::</span>year{<span class="dv">2016</span>};</span>
<span id="cb1-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb1-2" aria-hidden="true"></a><span class="kw">auto</span> y = <span class="dv">2016</span><span class="bu">y</span>;</span></code></pre></div>
<p>このとき, <code>year</code>は <i>partial-calendar-type (部分カレンダー型)</i> である. 他の部分カレンダー型と組み合わせることで, <code>year_month_day</code>などの <i>full-calendar-type (フルカレンダー型)</i> を生成することができる. フルカレンダー型は, 1 日の制度を持つタイムポイントであり, 部分カレンダー型である<code>year</code>, <code>month</code>, <code>day</code> で構成される. これらから<code>year_month_day</code>が構築されると, 内部で計算は一切起きず, 唯一起きることは, <code>year_month_day</code> が内部でそれらを格納するということだけである.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb2-1" aria-hidden="true"></a><span class="bu">std::</span>chrono<span class="bu">::</span>year_month_day ymd1{<span class="dv">2016</span><span class="bu">y</span>, month{<span class="dv">5</span>}, day{<span class="dv">29</span>}};</span></code></pre></div>
<p>この場合, すべての入力がコンパイル時定数であるので, <code>constexpr</code> にすることができる. さらに, <code>operator/</code>がオーバーロードされているため, 従来の日付の構文が利用できる.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb3-1" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="bu">std::</span>chrono<span class="bu">::</span>year_month_day ymd1{<span class="dv">2016</span><span class="bu">y</span>, month{<span class="dv">5</span>}, day{<span class="dv">29</span>}};</span>
<span id="cb3-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb3-2" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> ymd2 = <span class="dv">2016</span><span class="bu">y</span>/May/<span class="dv">29</span><span class="bu">d</span>;</span>
<span id="cb3-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb3-3" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> ymd3 = May/<span class="dv">29</span><span class="bu">d</span>/<span class="dv">2016</span><span class="bu">y</span>;</span>
<span id="cb3-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb3-4" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> ymd4 = <span class="dv">29</span><span class="bu">d</span>/May/<span class="dv">2016</span><span class="bu">y</span>;</span>
<span id="cb3-5"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb3-5" aria-hidden="true"></a><span class="kw">static_assert</span>(ymd1 == ymd2);</span>
<span id="cb3-6"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb3-6" aria-hidden="true"></a><span class="kw">static_assert</span>(ymd2 == ymd3);</span>
<span id="cb3-7"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb3-7" aria-hidden="true"></a><span class="kw">static_assert</span>(ymd3 == ymd4);</span>
<span id="cb3-8"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb3-8" aria-hidden="true"></a><span class="kw">static_assert</span>(ymd1.year() == <span class="dv">2016</span><span class="bu">y</span>);</span>
<span id="cb3-9"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb3-9" aria-hidden="true"></a><span class="kw">static_assert</span>(ymd1.month() == May);</span>
<span id="cb3-10"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb3-10" aria-hidden="true"></a><span class="kw">static_assert</span>(ymd1.day() == <span class="dv">29</span><span class="bu">d</span>);</span></code></pre></div>
ここで, <code>May</code>は月を表現する<code>month</code>型のオブジェクトであり, 他に<code>Jan</code>, <code>Feb</code>, <code>Mar</code>, <code>Apr</code>, <code>Jun</code>, <code>Jul</code>, <code>Aug</code>, <code>Sep</code>, <code>Oct</code>, <code>Nov</code>, <code>Dec</code>が, <em onclick="obj=document.getElementById(&#39;openmonth&#39;).style; obj.display=(obj.display==&#39;none&#39;)?&#39;block&#39;:&#39;none&#39;;"> <a style="font-style: normal; cursor:pointer;">次のように定義される(クリックで展開).</a> </em>
<div id="openmonth" style="display:none;clear:both;">
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb4-1" aria-hidden="true"></a><span class="kw">namespace</span> <span class="bu">std::</span>chrono {</span>
<span id="cb4-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb4-2" aria-hidden="true"></a></span>
<span id="cb4-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb4-3" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::month January{<span class="dv">1</span>};</span>
<span id="cb4-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb4-4" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::month February{<span class="dv">2</span>};</span>
<span id="cb4-5"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb4-5" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::month March{<span class="dv">3</span>};</span>
<span id="cb4-6"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb4-6" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::month April{<span class="dv">4</span>};</span>
<span id="cb4-7"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb4-7" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::month May{<span class="dv">5</span>};</span>
<span id="cb4-8"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb4-8" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::month June{<span class="dv">6</span>};</span>
<span id="cb4-9"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb4-9" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::month July{<span class="dv">7</span>};</span>
<span id="cb4-10"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb4-10" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::month August{<span class="dv">8</span>};</span>
<span id="cb4-11"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb4-11" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::month September{<span class="dv">9</span>};</span>
<span id="cb4-12"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb4-12" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::month October{<span class="dv">10</span>};</span>
<span id="cb4-13"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb4-13" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::month November{<span class="dv">11</span>};</span>
<span id="cb4-14"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb4-14" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::month December{<span class="dv">12</span>};</span>
<span id="cb4-15"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb4-15" aria-hidden="true"></a></span>
<span id="cb4-16"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb4-16" aria-hidden="true"></a>}</span></code></pre></div>
</div>
<p>カレンダーライブラリは, 例えばスカラ型で直接日付を指定するといったことはなく, 明示的な型指定による表現によって実現する. なお, 部分カレンダー型(<code>year</code>, <code>month</code> に加えて<code>day</code>型)は, すべて <i>Strong ordering</i><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> を満たし, 加えて以下のメンバ関数をもつ.</p>
<ul>
<li>デフォルトコンストラクタ, <code>unsigned</code>型(<code>year</code>型のみ<code>int</code>型)の値を受け付けるコンストラクタ</li>
<li>各型の単位においてそれを前後に進める, {前|後}置{イン|デ}クリメント演算子</li>
<li>各型の単位で計算を行う<code>+</code>, <code>-</code>の二項演算子</li>
<li>二項演算子と同様の計算を行い自身に代入する<code>+=</code>, <code>-=</code> の複合代入演算子</li>
<li><code>unsigned</code>型(<code>year</code>型のみ<code>int</code>型)の値への明示的な変換(<code>constexpr explicit operator unsigned() const noexcept;</code>)</li>
<li>指定された日付が各単位で適切であるかどうかをチェックする<code>ok</code></li>
</ul>
<p><code>year</code>型は, これに加えて, <code>is_leap</code>, <code>min</code>, <code>max</code> メンバ関数をもつ. <code>is_leap</code>は, 指定された年が閏年であるか判定できる. <code>min</code>, <code>max</code>は内部型の最小値と最大値を返す. また, 上記の通り<code>y</code>といったリテラル接尾語が定義される.<br> また<code>day</code>型は, <code>d</code>といったリテラル接尾語が定義される.</p>
<p>フルカレンダー型は, <code>sys_days</code>という型へ変換できる. これは, 次のように定義されている.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb5-1" aria-hidden="true"></a><span class="kw">constexpr</span> year_month_day::<span class="kw">operator</span> sys_days() <span class="at">const</span> <span class="kw">noexcept</span>;</span></code></pre></div>
フルカレンダー型は,<code>sys_days</code>型に変換することで,<code>system_clock::time_point</code>ファミリとの間で変換でき, これにより完全な相互運用が可能である. <code>sys_days</code> は <em onclick="obj=document.getElementById(&#39;opensys_days&#39;).style; obj.display=(obj.display==&#39;none&#39;)?&#39;block&#39;:&#39;none&#39;;"> <a style="font-style: normal; cursor:pointer;">次のように定義される(クリックで展開).</a> </em>
<div id="opensys_days" style="display:none;clear:both;">
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb6-1" aria-hidden="true"></a><span class="kw">using</span> days = duration&lt;<span class="dt">int32_t</span>, ratio_multiply&lt;ratio&lt;<span class="dv">24</span>&gt;, hours::period&gt;&gt;;</span>
<span id="cb6-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb6-2" aria-hidden="true"></a><span class="kw">template</span> &lt;<span class="kw">class</span> Duration&gt;</span>
<span id="cb6-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb6-3" aria-hidden="true"></a><span class="kw">using</span> sys_time = time_point&lt;system_clock, Duration&gt;;</span>
<span id="cb6-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb6-4" aria-hidden="true"></a><span class="kw">using</span> sys_days = sys_time&lt;days&gt;;</span></code></pre></div>
</div>
<p>加えて, <code>sys_days</code>には次の特性がある.</p>
<ul>
<li><code>sys_days</code>は, <code>system_clock::time_point</code>がマイクロ秒, またはナノ秒のカウントだけであるのと同様に, <code>system_clock</code>の基点(エポック)からの日数を示す.</li>
<li><code>sys_days</code>は, 切り捨てエラーなしで暗黙的に<code>system_clock::time_point</code>に変換される.</li>
<li><code>system_clock::time_point</code>は, 切り捨てエラーが含まれるため, 暗黙的に<code>sys_days</code>に変換されない.</li>
<li><code>system_clock::time_point_cast</code> または<code>floor</code>を使用した明示的な変換によって<code>system_clock::time_point</code>から<code>sys_days</code>へ変換することができる.</li>
</ul>
<p>内部で保持する部分カレンダー型<code>year</code>, <code>month</code>, <code>day</code> をそれぞれ<code>y_</code>, <code>m_</code>, <code>d_</code> としたとき, <code>year_month_day</code>から<code>sys_days</code>への変換時には(すなわち上記の<code>operator sys_days()</code>の呼び出し),</p>
<ul>
<li><code>year_month_day::ok()</code>が<code>true</code>の場合, <code>sys_days</code>の基点から<code>*this</code>までの日数を保持する<code>sys_days</code>を返す</li>
<li>そうでない場合, <code>y_.ok() &amp;&amp; m_.ok() == true</code> ならば <code>sys_days{y_/m_/last}</code> から <code>days</code>(<code>duration&lt;int32_t, ratio_multiply&lt;ratio&lt;24&gt;, hours::period&gt;&gt;</code>) の数だけ<code>sys_days{y_,m_,last}.day()</code>からオフセットされた<code>sys_days</code>を返す</li>
<li>そうでない場合, 未規定である</li>
</ul>
<p>ここで<code>year_month_day::ok</code>は, <code>y_.ok() &amp;&amp; m_.ok() == true</code> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∧</mo></mrow><annotation encoding="application/x-tex">\land</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∧</span></span></span></span> <code>1d</code> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≤</mo></mrow><annotation encoding="application/x-tex">\leq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≤</span></span></span></span> <code>d_</code> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≤</mo></mrow><annotation encoding="application/x-tex">\leq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≤</span></span></span></span> <code>(y_/m_/last).day()</code> であるとき <code>true</code> を, そうでない場合, <code>false</code> を返すメンバ関数である.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb7-1" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="bu">std::</span>chrono<span class="bu">::</span>system_clock<span class="bu">::</span>time_point tp = <span class="bu">std::</span>chrono<span class="bu">::</span>sys_days{<span class="dv">2016</span><span class="bu">y</span>/May/<span class="dv">29</span><span class="bu">d</span>}; <span class="co">// Convert date to time_point</span></span>
<span id="cb7-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb7-2" aria-hidden="true"></a><span class="kw">static_assert</span>(tp.time_since_epoch() == <span class="dv">1&#39;464&#39;480&#39;000&#39;000&#39;000</span><span class="bu">u</span><span class="er">s</span>);</span>
<span id="cb7-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb7-3" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> ymd = <span class="bu">std::</span>chrono<span class="bu">::</span>year_month_day{<span class="bu">std::</span>chrono<span class="bu">::</span>floor&lt;days&gt;(tp)}; <span class="co">// Convert time_point to date</span></span>
<span id="cb7-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb7-4" aria-hidden="true"></a><span class="kw">static_assert</span>(ymd == <span class="dv">2016</span><span class="bu">y</span>/May/<span class="dv">29</span><span class="bu">d</span>);</span>
<span id="cb7-5"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb7-5" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> tp = <span class="bu">std::</span>chrono<span class="bu">::</span>sys_days{<span class="dv">2016</span><span class="bu">y</span>/May/<span class="dv">29</span><span class="bu">d</span>} + <span class="dv">7</span><span class="bu">h</span> + <span class="dv">30</span><span class="bu">min</span>; <span class="co">// 2016-05-29 07:30 UTC</span></span>
<span id="cb7-6"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb7-6" aria-hidden="true"></a><span class="kw">static_assert</span>(year_month_day{sys_days{<span class="dv">2017</span><span class="bu">y</span>/January/<span class="dv">0</span>}}  == <span class="dv">2016</span><span class="bu">y</span>/December/<span class="dv">31</span>);</span>
<span id="cb7-7"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb7-7" aria-hidden="true"></a><span class="kw">static_assert</span>(year_month_day{sys_days{<span class="dv">2017</span><span class="bu">y</span>/January/<span class="dv">31</span>}} == <span class="dv">2017</span><span class="bu">y</span>/January/<span class="dv">31</span>);</span>
<span id="cb7-8"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb7-8" aria-hidden="true"></a><span class="kw">static_assert</span>(year_month_day{sys_days{<span class="dv">2017</span><span class="bu">y</span>/January/<span class="dv">32</span>}} == <span class="dv">2017</span><span class="bu">y</span>/February/<span class="dv">1</span>);</span></code></pre></div>
上述した, <code>days</code>の他に, <code>weeks</code>, <code>months</code>, <code>years</code> が <em onclick="obj=document.getElementById(&#39;openpartialcal&#39;).style; obj.display=(obj.display==&#39;none&#39;)?&#39;block&#39;:&#39;none&#39;;"> <a style="font-style: normal; cursor:pointer;">次のように定義される(クリックで展開).</a> </em>
<div id="openpartialcal" style="display:none;clear:both;">
<div class="sourceCode" id="cb8"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb8-1" aria-hidden="true"></a><span class="kw">using</span> weeks  = duration&lt;<span class="co">/* signed integer type of at least 22 bits */</span>, ratio_multiply&lt;ratio&lt;<span class="dv">7</span>&gt;, days::period&gt;&gt;;</span>
<span id="cb8-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb8-2" aria-hidden="true"></a><span class="kw">using</span> years  = duration&lt;<span class="co">/* signed integer type of at least 17 bits */</span>, ratio_multiply&lt;ratio&lt;<span class="dv">146097</span>, <span class="dv">400</span>&gt;, days::period&gt;&gt;;</span>
<span id="cb8-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb8-3" aria-hidden="true"></a><span class="kw">using</span> months = duration&lt;<span class="co">/* signed integer type of at least 20 bits */</span>, ratio_divide&lt;years::period, ratio&lt;<span class="dv">12</span>&gt;&gt;&gt;;</span></code></pre></div>
</div>
<ul>
<li><code>days</code>, <code>weeks</code>, <code>months</code>, <code>years</code>型は, それぞれ少なくとも $$40000 年の範囲をカバーする.</li>
<li><code>hours</code>のリテラル接尾語が<code>h</code>, <code>minutes</code>のリテラル接尾語が<code>min</code>, というように, 今までのリテラル接尾語は<code>duration</code>型へ対応していたが, 新規に追加される <code>y</code>, <code>d</code>といったリテラル接尾語は, <code>years</code>, <code>days</code>に対応するリテラル接尾語ではなく, 上述したように, <code>year</code>, <code>day</code>の部分カレンダー型に対応するリテラル接尾語である.</li>
<li>1 年を, 365.2425 日(グレゴリオ暦の平均長)と定義し, 1 月を, 30.436875 日<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mn>12</mn></mfrac></mstyle><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\dfrac{1}{12})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">12</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span> と定義するため, システム時刻(<code>time_point</code>)を利用した算出結果と, <code>year_month_day</code> を利用した算出結果は異なる.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb9-1" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> date1 = sys_days{<span class="dv">1997</span><span class="bu">y</span>/May/<span class="dv">30</span><span class="bu">d</span>} - months{<span class="dv">5</span>}; <span class="co">// 1996-12-28 19:34:30</span></span>
<span id="cb9-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb9-2" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> date2 = sys_days{<span class="dv">1997</span><span class="bu">y</span>/December/<span class="dv">29</span><span class="bu">d</span>} - years{<span class="dv">1</span>}; <span class="co">// 1996-12-28 18:10:48</span></span></code></pre></div>
<p>現実のカレンダーの利用方法として, たとえば「2016 年の 5 月 29 日」を, 「2016 年の 5 月第 5 日曜日」ということもよくあり, これを表現することもできる.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb10-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb10-1" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="bu">std::</span>chrono<span class="bu">::</span>system_clock<span class="bu">::</span>time_point tp = <span class="bu">std::</span>chrono<span class="bu">::</span>sys_days{Sunday[<span class="dv">5</span>]/May/<span class="dv">2016</span>}; <span class="co">// Convert date to time_point</span></span>
<span id="cb10-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb10-2" aria-hidden="true"></a><span class="kw">static_assert</span>(tp.time_since_epoch() == <span class="dv">1&#39;464&#39;480&#39;000&#39;000&#39;000</span><span class="bu">u</span><span class="er">s</span>);</span>
<span id="cb10-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb10-3" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> ymd = <span class="bu">std::</span>chrono<span class="bu">::</span>year_month_weekday{<span class="bu">std::</span>chrono<span class="bu">::</span>floor&lt;days&gt;(tp)}; <span class="co">// Convert time_point to date</span></span>
<span id="cb10-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb10-4" aria-hidden="true"></a><span class="kw">static_assert</span>(ymd == Sunday[<span class="dv">5</span>]/<span class="bu">std::</span>chrono<span class="bu">::</span>May/<span class="dv">2016</span>);</span>
<span id="cb10-5"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb10-5" aria-hidden="true"></a><span class="kw">static_assert</span>(<span class="dv">2016</span><span class="bu">y</span>/May/<span class="dv">29</span><span class="bu">d</span> == <span class="bu">std::</span>chrono<span class="bu">::</span>year_month_day{Sunday[<span class="dv">5</span>]/May/<span class="dv">2016</span>});</span>
<span id="cb10-6"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb10-6" aria-hidden="true"></a></span>
<span id="cb10-7"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb10-7" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> wdi = Sunday[<span class="dv">5</span>]; <span class="co">// wdi is the 5th Sunday of an as yet unspecified month</span></span>
<span id="cb10-8"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb10-8" aria-hidden="true"></a><span class="kw">static_assert</span>(wdi.weekday() == Sunday);</span>
<span id="cb10-9"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb10-9" aria-hidden="true"></a><span class="kw">static_assert</span>(wdi.index() == <span class="dv">5</span>);</span>
<span id="cb10-10"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb10-10" aria-hidden="true"></a><span class="kw">static_assert</span>(<span class="bu">std::</span>is_same&lt;<span class="kw">decltype</span>(Sunday), <span class="bu">std::</span>chrono<span class="bu">::</span>weekday&gt;::value);</span>
<span id="cb10-11"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb10-11" aria-hidden="true"></a><span class="kw">static_assert</span>(<span class="bu">std::</span>is_same&lt;<span class="kw">decltype</span>(wdi.index()), <span class="bu">std::</span>chrono<span class="bu">::</span>weekday_indexed&gt;::value);</span></code></pre></div>
ここで, <code>Sunday</code>は<code>weekday</code>型であり, 日曜日を表現するリテラルとして定義され, 他にも<code>Monday</code>, <code>Tuesday</code>, <code>Wednesday</code>, <code>Thursday</code>, <code>Friday</code>, <code>Saturday</code>が <em onclick="obj=document.getElementById(&#39;openweekday&#39;).style; obj.display=(obj.display==&#39;none&#39;)?&#39;block&#39;:&#39;none&#39;;"> <a style="font-style: normal; cursor:pointer;">次のように定義される(クリックで展開).</a> </em>
<div id="openweekday" style="display:none;clear:both;">
<div class="sourceCode" id="cb11"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb11-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb11-1" aria-hidden="true"></a><span class="kw">namespace</span> <span class="bu">std::</span>chrono {</span>
<span id="cb11-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb11-2" aria-hidden="true"></a></span>
<span id="cb11-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb11-3" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::weekday Sunday{<span class="dv">0</span>};</span>
<span id="cb11-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb11-4" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::weekday Monday{<span class="dv">1</span>};</span>
<span id="cb11-5"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb11-5" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::weekday Tuesday{<span class="dv">2</span>};</span>
<span id="cb11-6"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb11-6" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::weekday Wednesday{<span class="dv">3</span>};</span>
<span id="cb11-7"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb11-7" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::weekday Thursday{<span class="dv">4</span>};</span>
<span id="cb11-8"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb11-8" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::weekday Friday{<span class="dv">5</span>};</span>
<span id="cb11-9"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb11-9" aria-hidden="true"></a><span class="kw">inline</span> <span class="kw">constexpr</span> chrono::weekday Saturday{<span class="dv">6</span>};</span>
<span id="cb11-10"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb11-10" aria-hidden="true"></a></span>
<span id="cb11-11"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb11-11" aria-hidden="true"></a>}</span></code></pre></div>
</div>
<p><code>weekday</code>型は, <i>Strong equality</i><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> を満たし, 加えて, 次のメンバ関数を持つ.</p>
<ul>
<li>デフォルトコンストラクタ, <code>unsigned</code>, <code>sys_days</code>, 後に取り上げている<code>local_days</code>型のオブジェクトを受け付けるコンストラクタ</li>
<li>曜日を前後に進める{前|後}置{イン|デ}クリメント演算子</li>
<li><code>weekday</code>, <code>days</code>型のオブジェクトを受け付けて曜日の計算を行う<code>+</code>, <code>-</code>の二項演算子</li>
<li>二項演算子と同様の計算を行い自身に代入する<code>+=</code>, <code>-=</code> の複合代入演算子</li>
<li>指定された曜日が適切であるかどうかをチェックする<code>ok</code></li>
<li><code>operator []</code></li>
</ul>
<p><code>operator []</code>は, <code>unsigned</code>型を引数として呼び出すと, <code>weekday_indexed</code>型のオブジェクトが返され, <code>last_spec</code>型のオブジェクトを引数として呼び出すと, <code>weekday_last</code>型のオブジェクトが返される.</p>
<ul>
<li><code>weekday_indexed</code>型は, 月の第 1, 第 2, 第 3, 第 4 または第 5 曜日を表すために使用され, 上記の通り, <code>weekday</code>メンバ関数, <code>index</code>メンバ関数を持つ他, <code>ok</code>メンバ関数を持つ.</li>
<li><code>weekday_last</code>型は, 月の最後の<code>weekday</code>を表すために使用され, <code>weekday</code>メンバ関数, <code>ok</code>メンバ関数を持つ,</li>
<li><code>last_spec</code>型は, 最終日を表すために使用され, 同型のオブジェクト<code>last</code>が<code>chrono</code>名前空間下に定義される.</li>
</ul>
<p>例えば次のようにして, ある月の最終日, 最終 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 曜日などを表現することができる.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb12-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb12-1" aria-hidden="true"></a><span class="kw">auto</span> today = <span class="bu">std::</span>chrono<span class="bu">::</span>year_month_day{<span class="bu">std::</span>chrono<span class="bu">::</span>floor&lt;<span class="bu">std::</span>chrono<span class="bu">::</span>days&gt;(<span class="bu">std::</span>chrono<span class="bu">::</span>system_clock<span class="bu">::</span>now())};</span>
<span id="cb12-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb12-2" aria-hidden="true"></a><span class="kw">auto</span> last_day = today.year()/today.month()/last; <span class="co">// last day of this month</span></span>
<span id="cb12-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb12-3" aria-hidden="true"></a><span class="kw">auto</span> last_Sunday = today.year()/today.month()/Sunday[last]; <span class="co">// last Sundayday of this month</span></span>
<span id="cb12-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb12-4" aria-hidden="true"></a></span>
<span id="cb12-5"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb12-5" aria-hidden="true"></a><span class="kw">static_assert</span>(<span class="bu">std::</span>is_same&lt;<span class="kw">decltype</span>(Sunday[<span class="dv">5</span>]), <span class="bu">std::</span>chrono<span class="bu">::</span>weekday_indexed&gt;::value);</span>
<span id="cb12-6"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb12-6" aria-hidden="true"></a><span class="kw">static_assert</span>(<span class="bu">std::</span>is_same&lt;<span class="kw">decltype</span>(Sunday[last]), <span class="bu">std::</span>chrono<span class="bu">::</span>weekday_last&gt;::value);</span></code></pre></div>
<p>他に, 年を未指定とし, 特定の月日を表す, <code>month_day</code>, 月の最終日を表す<code>month_day_last</code>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> 番目の曜日を表す<code>month_weekday</code>, 月の最終曜日を表す<code>month_weekday_last</code>と, 日を未指定とし, 特定の年月を表す, <code>year_month</code>, 前述した<code>year_month_day</code>, 特定の年月の最終日を表す<code>year_month_day_last</code>, 特定の年月の <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> 番目の曜日を表す<code>year_month_weekday</code>, 特定の年月の最終曜日を表す<code>year_month_weekday_last</code> が提供される.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb13-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-1" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> md = February/<span class="dv">1</span><span class="bu">d</span>;</span>
<span id="cb13-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-2" aria-hidden="true"></a><span class="kw">static_assert</span>(<span class="bu">std::</span>is_same&lt;<span class="kw">decltype</span>(md), <span class="bu">std::</span>chrono<span class="bu">::</span>month_day&gt;::value);</span>
<span id="cb13-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-3" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> mdl = February/last;  <span class="co">// mdl is the last day of February of an as yet unspecified year</span></span>
<span id="cb13-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-4" aria-hidden="true"></a><span class="kw">static_assert</span>(mdl.month() == February);</span>
<span id="cb13-5"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-5" aria-hidden="true"></a><span class="kw">static_assert</span>(<span class="bu">std::</span>is_same&lt;<span class="kw">decltype</span>(mdl), <span class="bu">std::</span>chrono<span class="bu">::</span>month_day_last&gt;::value);</span>
<span id="cb13-6"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-6" aria-hidden="true"></a>constxpr <span class="kw">auto</span> mw = February/Sunday[<span class="dv">5</span>];</span>
<span id="cb13-7"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-7" aria-hidden="true"></a><span class="kw">static_assert</span>(<span class="bu">std::</span>is_same&lt;<span class="kw">decltype</span>(mw), <span class="bu">std::</span>chrono<span class="bu">::</span>month_weekday&gt;::value);</span>
<span id="cb13-8"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-8" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> mwl = February/Sunday[last];</span>
<span id="cb13-9"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-9" aria-hidden="true"></a><span class="kw">static_assert</span>(<span class="bu">std::</span>is_same&lt;<span class="kw">decltype</span>(mwl), <span class="bu">std::</span>chrono<span class="bu">::</span>month_weekday_last&gt;::value);</span>
<span id="cb13-10"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-10" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> ym = <span class="dv">2016</span><span class="bu">y</span>/February;</span>
<span id="cb13-11"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-11" aria-hidden="true"></a><span class="kw">static_assert</span>(<span class="bu">std::</span>is_same&lt;<span class="kw">decltype</span>(ym), <span class="bu">std::</span>chrono<span class="bu">::</span>year_month&gt;::value);</span>
<span id="cb13-12"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-12" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> ymd = <span class="dv">2016</span><span class="bu">y</span>/February/<span class="dv">1</span><span class="bu">d</span>;</span>
<span id="cb13-13"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-13" aria-hidden="true"></a><span class="kw">static_assert</span>(<span class="bu">std::</span>is_same&lt;<span class="kw">decltype</span>(ymd), <span class="bu">std::</span>chrono<span class="bu">::</span>year_month_day&gt;::value);</span>
<span id="cb13-14"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-14" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> ymdl = <span class="dv">2016</span><span class="bu">y</span>/February/last;</span>
<span id="cb13-15"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-15" aria-hidden="true"></a><span class="kw">static_assert</span>(<span class="bu">std::</span>is_same&lt;<span class="kw">decltype</span>(ymdl), <span class="bu">std::</span>chrono<span class="bu">::</span>year_month_day_last&gt;::value);</span>
<span id="cb13-16"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-16" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> ymw = <span class="dv">2016</span><span class="bu">y</span>/February/Sunday[<span class="dv">1</span>];</span>
<span id="cb13-17"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-17" aria-hidden="true"></a><span class="kw">static_assert</span>(<span class="bu">std::</span>is_same&lt;<span class="kw">decltype</span>(ymw), <span class="bu">std::</span>chrono<span class="bu">::</span>year_month_weekday&gt;::value);</span>
<span id="cb13-18"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-18" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> ymwl = <span class="dv">2016</span><span class="bu">y</span>/February/last;</span>
<span id="cb13-19"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb13-19" aria-hidden="true"></a><span class="kw">static_assert</span>(<span class="bu">std::</span>is_same&lt;<span class="kw">decltype</span>(ymwl), <span class="bu">std::</span>chrono<span class="bu">::</span>year_month_day_last&gt;::value);</span></code></pre></div>
<p>フルカレンダー型, 部分カレンダー型, <code>sys_days</code>型の全てで, <code>operator &lt;&lt;</code>のオーバーロードによる IO ストリームへの出力機能が提供される他, 非メンバ関数として, <code>to_stream</code>, <code>from_stream</code> が提供される. これらはそれぞれ, 指定されたフォーマットの通りに出力する機能と, 指定されたフォーマットを使用して入力ストリームから解析する機能を持つ.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb14-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb14-1" aria-hidden="true"></a><span class="bu">std::</span>cout &lt;&lt; <span class="bu">std::</span>chrono<span class="bu">::</span>sys_days{Sunday[<span class="dv">5</span>]/May/<span class="dv">2016</span>} &lt;&lt; <span class="bu">std::</span>endl; <span class="co">// 2016-05-29</span></span>
<span id="cb14-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb14-2" aria-hidden="true"></a><span class="bu">std::</span>chrono<span class="bu">::</span>to_stream(<span class="bu">std::</span>cout, <span class="st">&quot;%b/</span><span class="sc">%d</span><span class="st">/%Y </span><span class="sc">%A</span><span class="st"> %T&quot;</span>, <span class="bu">std::</span>chrono<span class="bu">::</span>sys_days{<span class="dv">2016</span><span class="bu">y</span>/May/<span class="dv">29</span><span class="bu">d</span>} + <span class="dv">30</span><span class="bu">min</span>); <span class="co">// May/29/2016 Sunday 00:30:00</span></span>
<span id="cb14-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb14-3" aria-hidden="true"></a></span>
<span id="cb14-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb14-4" aria-hidden="true"></a><span class="kw">auto</span> is = <span class="bu">std::</span>istringstream{<span class="st">&quot;2016-5-26&quot;</span>};</span>
<span id="cb14-5"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb14-5" aria-hidden="true"></a><span class="kw">auto</span> tp = <span class="bu">std::</span>chrono<span class="bu">::</span>sys_days{};</span>
<span id="cb14-6"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb14-6" aria-hidden="true"></a><span class="bu">std::</span>chrono<span class="bu">::</span>from_stream(in, <span class="st">&quot;</span><span class="sc">%F</span><span class="st">&quot;</span>, tp);</span>
<span id="cb14-7"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb14-7" aria-hidden="true"></a><span class="cf">if</span> (!is.fail()) <span class="bu">std::</span>cout &lt;&lt; tp &lt;&lt; <span class="bu">std::</span>endl; <span class="co">// 2016-05-26</span></span></code></pre></div>
<p>また, <code>time_of_day</code>クラスが提供される. これは, <code>hours</code>, <code>minutes</code>, <code>seconds</code>, <code>duration&lt;Rep, Period&gt;</code> の 4 つに対する特殊化が行われており, それぞれ午前 0 時からの時間, 時間:分, 時間:分:秒, 時間:分:秒:<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> といった書式設定ができる.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb15-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-1" aria-hidden="true"></a><span class="bu">std::</span>chrono<span class="bu">::</span>time_of_day&lt;<span class="bu">std::</span>chrono<span class="bu">::</span>hours&gt; todh(<span class="dv">1</span><span class="bu">h</span>);</span>
<span id="cb15-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-2" aria-hidden="true"></a>todh.make12();</span>
<span id="cb15-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-3" aria-hidden="true"></a><span class="bu">std::</span>cout &lt;&lt; todh &lt;&lt; <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>; <span class="co">// 1am</span></span>
<span id="cb15-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-4" aria-hidden="true"></a>todh.make24();</span>
<span id="cb15-5"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-5" aria-hidden="true"></a><span class="bu">std::</span>cout &lt;&lt; todh &lt;&lt; <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>; <span class="co">// 0100</span></span>
<span id="cb15-6"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-6" aria-hidden="true"></a></span>
<span id="cb15-7"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-7" aria-hidden="true"></a><span class="bu">std::</span>chrono<span class="bu">::</span>time_of_day&lt;<span class="bu">std::</span>chrono<span class="bu">::</span>minutes&gt; todm(<span class="dv">1</span><span class="bu">h</span> + <span class="dv">30</span><span class="bu">min</span>);</span>
<span id="cb15-8"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-8" aria-hidden="true"></a>todm.make12();</span>
<span id="cb15-9"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-9" aria-hidden="true"></a><span class="bu">std::</span>cout &lt;&lt; todm &lt;&lt; <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>; <span class="co">// 1:30am</span></span>
<span id="cb15-10"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-10" aria-hidden="true"></a>todm.make24();</span>
<span id="cb15-11"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-11" aria-hidden="true"></a><span class="bu">std::</span>cout &lt;&lt; todm &lt;&lt; <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>; <span class="co">// 01:30</span></span>
<span id="cb15-12"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-12" aria-hidden="true"></a></span>
<span id="cb15-13"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-13" aria-hidden="true"></a><span class="bu">std::</span>chrono<span class="bu">::</span>time_of_day&lt;<span class="bu">std::</span>chrono<span class="bu">::</span>seconds&gt; tods(<span class="dv">1</span><span class="bu">h</span> + <span class="dv">30</span><span class="bu">min</span> + <span class="dv">30</span><span class="bu">s</span>);</span>
<span id="cb15-14"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-14" aria-hidden="true"></a>tods.make12();</span>
<span id="cb15-15"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-15" aria-hidden="true"></a><span class="bu">std::</span>cout &lt;&lt; tods &lt;&lt; <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>; <span class="co">// 1:30:30am</span></span>
<span id="cb15-16"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-16" aria-hidden="true"></a>tods.make24();</span>
<span id="cb15-17"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-17" aria-hidden="true"></a><span class="bu">std::</span>cout &lt;&lt; tods &lt;&lt; <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>; <span class="co">// 01:30:30</span></span>
<span id="cb15-18"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-18" aria-hidden="true"></a></span>
<span id="cb15-19"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-19" aria-hidden="true"></a><span class="bu">std::</span>chdono<span class="bu">::</span>time_of_day&lt;<span class="bu">std::</span>chrono<span class="bu">::</span>milliseconds&gt; todms(<span class="dv">1</span><span class="bu">h</span> + <span class="dv">30</span><span class="bu">min</span> + <span class="dv">30</span><span class="bu">s</span> + <span class="dv">30</span><span class="bu">ms</span>);</span>
<span id="cb15-20"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-20" aria-hidden="true"></a>todms.make12();</span>
<span id="cb15-21"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-21" aria-hidden="true"></a><span class="bu">std::</span>cout &lt;&lt; todms &lt;&lt; <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>; <span class="co">// 1:30:30.030am</span></span>
<span id="cb15-22"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-22" aria-hidden="true"></a>todms.make24();</span>
<span id="cb15-23"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb15-23" aria-hidden="true"></a><span class="bu">std::</span>cout &lt;&lt; todms &lt;&lt; <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>; <span class="co">// 01:30:30.030</span></span></code></pre></div>
<h3 id="タイムゾーン">タイムゾーン</h3>
タイムゾーンライブラリは, <a href="http://www.iana.org/time-zones" target="_blank" rel="nofollow noopener">IANA Time Zone Database</a> のパーサーとして提供される<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. <a href="http://www.iana.org/time-zones" target="_blank" rel="nofollow noopener">IANA Time Zone Database</a> には, UTC からのオフセットと地域の省略名<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>が含まれており, さらに該当する場合, 夏時間(サマータイム)のルールも含まれる. これを表現した, <code>tzdb</code>, またバージョンごとの<code>tzdb</code>のリストとなっている<code>tzdb_list</code>を介して, 任意の<code>tzdb</code>にアクセスすることができる. <code>tzdb_list</code>はシングルトンであり, 非メンバ関数<code>get_tzdb_list</code>からその参照を得て利用する. <em onclick="obj=document.getElementById(&#39;opentimezones&#39;).style; obj.display=(obj.display==&#39;none&#39;)?&#39;block&#39;:&#39;none&#39;;"> <a style="font-style: normal; cursor:pointer;">関連する宣言を下記に抜粋する(クリックで展開).</a> </em>
<div id="opentimezones" style="display:none;clear:both;">
<div class="sourceCode" id="cb16"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb16-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-1" aria-hidden="true"></a><span class="kw">namespace</span> std { <span class="kw">namespace</span> chrono {</span>
<span id="cb16-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-2" aria-hidden="true"></a></span>
<span id="cb16-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-3" aria-hidden="true"></a><span class="kw">struct</span> <span class="dt">local_t</span> {};</span>
<span id="cb16-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-4" aria-hidden="true"></a><span class="kw">template</span> &lt;<span class="kw">class</span> Duration&gt;</span>
<span id="cb16-5"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-5" aria-hidden="true"></a><span class="kw">using</span> local_time = time_point&lt;<span class="dt">local_t</span>, Duration&gt;;</span>
<span id="cb16-6"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-6" aria-hidden="true"></a><span class="kw">using</span> local_seconds = local_time&lt;seconds&gt;;</span>
<span id="cb16-7"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-7" aria-hidden="true"></a><span class="kw">using</span> local_days = local_time&lt;days&gt;;</span>
<span id="cb16-8"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-8" aria-hidden="true"></a></span>
<span id="cb16-9"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-9" aria-hidden="true"></a><span class="kw">struct</span> sys_info {</span>
<span id="cb16-10"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-10" aria-hidden="true"></a>    sys_seconds   begin;</span>
<span id="cb16-11"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-11" aria-hidden="true"></a>    sys_seconds   end;</span>
<span id="cb16-12"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-12" aria-hidden="true"></a>    seconds       offset;</span>
<span id="cb16-13"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-13" aria-hidden="true"></a>    minutes       save;</span>
<span id="cb16-14"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-14" aria-hidden="true"></a>    string        abbrev;</span>
<span id="cb16-15"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-15" aria-hidden="true"></a>};</span>
<span id="cb16-16"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-16" aria-hidden="true"></a></span>
<span id="cb16-17"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-17" aria-hidden="true"></a><span class="kw">struct</span> local_info {</span>
<span id="cb16-18"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-18" aria-hidden="true"></a>    <span class="kw">enum</span> {unique, nonexistent, ambiguous} result;</span>
<span id="cb16-19"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-19" aria-hidden="true"></a>    sys_info first;</span>
<span id="cb16-20"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-20" aria-hidden="true"></a>    sys_info second;</span>
<span id="cb16-21"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-21" aria-hidden="true"></a>};</span>
<span id="cb16-22"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-22" aria-hidden="true"></a></span>
<span id="cb16-23"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-23" aria-hidden="true"></a><span class="kw">enum</span> <span class="kw">class</span> choose {earliest, latest};</span>
<span id="cb16-24"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-24" aria-hidden="true"></a></span>
<span id="cb16-25"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-25" aria-hidden="true"></a><span class="kw">class</span> time_zone {</span>
<span id="cb16-26"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-26" aria-hidden="true"></a><span class="kw">public</span>:</span>
<span id="cb16-27"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-27" aria-hidden="true"></a>    time_zone(<span class="at">const</span> time_zone&amp;) = <span class="kw">delete</span>;</span>
<span id="cb16-28"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-28" aria-hidden="true"></a>    time_zone&amp; <span class="kw">operator</span>=(<span class="at">const</span> time_zone&amp;) = <span class="kw">delete</span>;</span>
<span id="cb16-29"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-29" aria-hidden="true"></a>    <span class="at">const</span> string&amp; name() <span class="at">const</span> <span class="kw">noexcept</span>;</span>
<span id="cb16-30"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-30" aria-hidden="true"></a>    <span class="kw">template</span> &lt;<span class="kw">class</span> Duration&gt; sys_info   get_info(sys_time&lt;Duration&gt; st)   <span class="at">const</span>;</span>
<span id="cb16-31"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-31" aria-hidden="true"></a>    <span class="kw">template</span> &lt;<span class="kw">class</span> Duration&gt; local_info get_info(local_time&lt;Duration&gt; tp) <span class="at">const</span>;</span>
<span id="cb16-32"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-32" aria-hidden="true"></a></span>
<span id="cb16-33"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-33" aria-hidden="true"></a>    <span class="kw">template</span> &lt;<span class="kw">class</span> Duration&gt;</span>
<span id="cb16-34"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-34" aria-hidden="true"></a>    sys_time&lt;<span class="kw">typename</span> <span class="dt">common_type</span>&lt;Duration, seconds&gt;::type&gt;</span>
<span id="cb16-35"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-35" aria-hidden="true"></a>    to_sys(local_time&lt;Duration&gt; tp) <span class="at">const</span>;</span>
<span id="cb16-36"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-36" aria-hidden="true"></a></span>
<span id="cb16-37"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-37" aria-hidden="true"></a>    <span class="kw">template</span> &lt;<span class="kw">class</span> Duration&gt;</span>
<span id="cb16-38"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-38" aria-hidden="true"></a>    sys_time&lt;<span class="kw">typename</span> <span class="dt">common_type</span>&lt;Duration, seconds&gt;::type&gt;</span>
<span id="cb16-39"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-39" aria-hidden="true"></a>    to_sys(local_time&lt;Duration&gt; tp, choose z) <span class="at">const</span>;</span>
<span id="cb16-40"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-40" aria-hidden="true"></a></span>
<span id="cb16-41"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-41" aria-hidden="true"></a>    <span class="kw">template</span> &lt;<span class="kw">class</span> Duration&gt;</span>
<span id="cb16-42"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-42" aria-hidden="true"></a>    local_time&lt;<span class="kw">typename</span> <span class="dt">common_type</span>&lt;Duration, seconds&gt;::type&gt;</span>
<span id="cb16-43"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-43" aria-hidden="true"></a>    to_local(sys_time&lt;Duration&gt; tp) <span class="at">const</span>;</span>
<span id="cb16-44"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-44" aria-hidden="true"></a>};</span>
<span id="cb16-45"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-45" aria-hidden="true"></a></span>
<span id="cb16-46"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-46" aria-hidden="true"></a><span class="kw">struct</span> tzdb {</span>
<span id="cb16-47"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-47" aria-hidden="true"></a>    string            version;</span>
<span id="cb16-48"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-48" aria-hidden="true"></a>    vector&lt;time_zone&gt; zones;</span>
<span id="cb16-49"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-49" aria-hidden="true"></a>    vector&lt;link&gt;      links;</span>
<span id="cb16-50"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-50" aria-hidden="true"></a>    vector&lt;leap&gt;      leaps;</span>
<span id="cb16-51"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-51" aria-hidden="true"></a></span>
<span id="cb16-52"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-52" aria-hidden="true"></a>    <span class="at">const</span> time_zone* locate_zone(string_view tz_name) <span class="at">const</span>;</span>
<span id="cb16-53"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-53" aria-hidden="true"></a>    <span class="at">const</span> time_zone* current_zone() <span class="at">const</span>;</span>
<span id="cb16-54"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-54" aria-hidden="true"></a>};</span>
<span id="cb16-55"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-55" aria-hidden="true"></a></span>
<span id="cb16-56"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-56" aria-hidden="true"></a><span class="kw">class</span> tzdb_list {</span>
<span id="cb16-57"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-57" aria-hidden="true"></a>    atomic&lt;tzdb*&gt; <span class="va">head_</span>{<span class="kw">nullptr</span>};  <span class="co">// exposition only</span></span>
<span id="cb16-58"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-58" aria-hidden="true"></a><span class="kw">public</span>:</span>
<span id="cb16-59"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-59" aria-hidden="true"></a>    <span class="kw">class</span> const_iterator;</span>
<span id="cb16-60"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-60" aria-hidden="true"></a>    <span class="at">const</span> tzdb&amp; front() <span class="at">const</span> <span class="kw">noexcept</span>;</span>
<span id="cb16-61"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-61" aria-hidden="true"></a>    const_iterator erase_after(const_iterator p) <span class="kw">noexcept</span>;</span>
<span id="cb16-62"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-62" aria-hidden="true"></a></span>
<span id="cb16-63"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-63" aria-hidden="true"></a>    const_iterator begin() <span class="at">const</span> <span class="kw">noexcept</span>;</span>
<span id="cb16-64"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-64" aria-hidden="true"></a>    const_iterator end()   <span class="at">const</span> <span class="kw">noexcept</span>;</span>
<span id="cb16-65"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-65" aria-hidden="true"></a></span>
<span id="cb16-66"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-66" aria-hidden="true"></a>    const_iterator cbegin() <span class="at">const</span> <span class="kw">noexcept</span>;</span>
<span id="cb16-67"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-67" aria-hidden="true"></a>    const_iterator cend()   <span class="at">const</span> <span class="kw">noexcept</span>;</span>
<span id="cb16-68"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-68" aria-hidden="true"></a>};</span>
<span id="cb16-69"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-69" aria-hidden="true"></a></span>
<span id="cb16-70"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb16-70" aria-hidden="true"></a>} }</span></code></pre></div>
</div>
<ul>
<li><code>local_time</code>は<code>local_t</code>という空の擬似クロック型が指定されており, これは当然 C++ の Clock ライブラリコンセプトを満たしていないが, 未定義のタイムゾーンに関するローカル時刻であることを示す.</li>
<li><code>sys_info</code>構造体は, <code>time_zone</code>と<code>sys_time</code>, または<code>local_time</code>の組み合わせ, および<code>zoned_time</code>から取得することができる. 実質的には, <code>time_zone</code>と<code>sys_time</code>のペアであり, 低レベル API を表現する. <code>sys_time</code>から<code>local_time</code>への通常の変換では, 暗黙的にこの構造体が使用される.
<ul>
<li><code>begin</code>, <code>end</code>フィールドは, <code>time_zone</code>および<code>time_point</code>について<code>offset</code>と<code>abbrev</code>が<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo></mrow><annotation encoding="application/x-tex">[</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span></span></span></span><code>begin</code>, <code>end</code><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mclose">)</span></span></span></span> であることを示す.</li>
<li><code>offset</code>フィールドは, 関連する<code>time_zone</code>および<code>time_point</code>に有効な UTC オフセットを示す(<code>offset = local_time - sys_time</code>).</li>
<li><code>save</code>フィールドは, 通常<code>local_time</code>と<code>sys_time</code>の変換では必要のない“余分な”情報であるが, サマータイムの対応で必要となる. <code>save != 0min</code>の場合, この <code>sys_info</code> はサマータイムの時間帯にあると判断する. <code>offset - save</code>によって, この<code>time_zone</code>がサマータイムに対応できていない可能性を導出できる. しかし, この情報は正式なものではなく, そのような情報を確実に取得する唯一の方法は, <code>save == 0min</code>である<code>sys_info</code>を返す<code>time_point</code>と, 確認したい<code>time_zone</code>を照会することである.</li>
<li><code>abbrev</code>フィールドは, 関連する<code>time_zone</code>および<code>time_point</code>に使用される現在の略語を示す. 略語は, <code>time_zone</code>間で一意でないため, 略語を<code>time_zone</code>と UTC のオフセットに確実にマッピングすることはできない</li>
<li>IO ストリームに対応している. <code>zoned_time zt = { &quot;Asia/Tokyo&quot;, system_clock::now() }; std::cout &lt;&lt; zt.get_info() &lt;&lt; &#39;\n&#39;;</code></li>
</ul></li>
<li><code>local_info</code>構造体は, 低レベル API を表す. <code>local_time</code>から<code>sys_time</code>への通常の変換では, 暗黙的にこの構造体が使用される.
<ul>
<li><code>local_time</code>から<code>sys_time</code>への変換が唯一(サマータイムでない)で, <code>result == unique</code> である場合, <code>first</code>が正しい<code>sys_info</code>がセットされ, <code>second</code>が 0 で初期化される.</li>
<li>変換が存在しない(<code>result == noexistent</code>)<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>場合, <code>first</code>は<code>local_time</code>の直前で終了する<code>sys_info</code>がセットされ, <code>second</code>は<code>local_time</code>の直後に開始する<code>sys_info</code>がセットされる.</li>
<li>変換が曖昧(<code>result == ambiguous</code>)<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>な場合, <code>first</code>は<code>local_time</code>の直後に終了する<code>sys_info</code>がセットされ, <code>second</code>は<code>local_time</code>の直前で開始する<code>sys_info</code>がセットされる.</li>
<li>IO ストリームに対応している. <code>std::cout &lt;&lt; get_tzdb().current_zone()-&gt;get_info(local_days{2016y/May/29d}) &lt;&lt; &#39;\n&#39;;</code></li>
</ul></li>
<li><code>time_zone</code>構造体は, 特定の地域の全てのタイムゾーン遷移を表現する. データベースの初期化の過程で, 現在地のタイムゾーン, およびタイムゾーンの情報をなんらかの方法<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>で構築する. <i>Strong ordering</i><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> を満たす.
<ul>
<li><code>name</code>メンバ関数によって, <code>time_zone</code>の名前<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>を取得できる.</li>
<li><code>get_info</code>メンバ関数によって, <code>sys_info</code>, <code>local_info</code>を取得できる.</li>
<li><code>to_sys</code>メンバ関数によって, <code>sys_time</code>, <code>local_time</code>を取得できる.
<ul>
<li><code>time_zone::to_sys(local_time&lt;Duration&gt; tp) const;</code>: 少なくとも<code>seconds</code>と同じぐらいの<code>sys_time</code>であり, 引数の精度がさらに高ければそれに合わせられる. <code>tp</code>から<code>sys_time</code>への変換が曖昧<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a>である場合, <code>ambiguous_local_time</code>例外をスローする<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a>. <code>tp</code>から<code>sys_time</code>への変換が存在しない<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a>場合, <code>nonexistent_local_time</code>例外をスローする<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a>.</li>
<li><code>time_zone::to_sys(local_time&lt;Duration&gt; tp, choose z) const;</code>: 少なくとも<code>seconds</code>と同じぐらいの<code>sys_time</code>であり, 引数の精度がさらに高ければそれに合わせられる. <code>tp</code>から<code>sys_time</code>への変換が曖昧<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a>があいまいである場合, <code>z == choose::earliest</code>の場合は, サマータイム以前の<code>sys_time</code>を返し, <code>z == choose::latest</code>の場合は, サマータイム以後の<code>sys_time</code>を返す. <code>tp</code> が 2 つの UTC <code>time_point</code>の間に存在しない時間を表す場合, 2 つの UTC <code>time_point</code>は同じになり, UTC <code>time_point</code>が返される.</li>
<li><code>time_zone::to_local(sys_time&lt;Duration&gt; tp) const;</code>: <code>tp</code> と自身の<code>time_zone</code>に関連づけられた<code>local_time</code>を返す.<br />
</li>
</ul></li>
</ul></li>
<li><code>tzdb</code>は, 前述した通り, タイムゾーンデータベースを表現する.
<ul>
<li><code>version</code>は, そのデータベースバージョンを表す. <code>zones</code>, <code>links</code>, <code>leaps</code>は, 検索の高速化のために, 構築時に昇順ソートされる.</li>
<li><code>locate_zone</code>メンバ関数から, 与えられた<code>string_view</code>オブジェクトと<code>name()</code>が等価である<code>time_zone</code>が見つかった場合, その<code>time_zone</code>へのポインタを取得できる. そうでない場合, 与えられた<code>string_view</code>と<code>link.name()</code>(ここで, <code>link</code>は後述している<code>time_zone</code>の代替名を表現するクラスである)が等価である<code>link</code>が見つかった場合, <code>zone.name() == link.target()</code>の<code>time_zone</code>ポインタが取得できる. そうでない場合, <code>runtime_error</code>例外を送出する. 例外送出以外でこの関数から処理が返るとき, 返される戻り値は必ず有効な<code>time_zone</code>へのポインタである.</li>
<li><code>current_zone</code>メンバ関数から, コンピューターに設定されたローカルタイムゾーンを取得できる.</li>
</ul></li>
<li><code>tzdb_list</code>は, <code>tzdb</code>のアトミックポインターをもつ, <code>tzdb</code>のシングルトンリストである.　複数のバージョンのデータベースを, 同リストを介して一度に使用することができる. 例:<code>for (auto&amp;&amp; v : get_tzdb_list()) { std::cout &lt;&lt; v &lt;&lt; &#39;\n&#39;; }</code>
<ul>
<li><code>front</code>メンバ関数によって, 先頭<code>tzdb</code>の参照を得ることができる. これは, <code>reload_tzdb</code>非メンバ関数に対してスレッドセーフである.</li>
<li><code>erase_after</code>メンバ関数によって, 与えられたイテレータの後に参照する<code>tzdb</code>を消去する. 消去された要素の次の要素を指すイテレータが返される. そのような要素が存在しない場合, メンバ関数<code>end</code>を呼び出し, その結果を返す. なお, ここで消去された<code>tzdb</code>を参照することを除いて, ポインター, 参照, イテレータは無効にならない. また, メンバ関数<code>begin</code>を呼び出し, それによって参照される<code>tzdb</code>を消去することはできない.</li>
<li><code>begin</code>メンバ関数によって, コンテナ内の最初の<code>tzdb</code>を参照するイテレータ取得できる. <code>cbegin</code>メンバ関数は<code>begin</code>メンバ関数の<code>const</code>版である.</li>
<li><code>end</code>メンバ関数によって, コンテナ内の最後の<code>tzdb</code>より 1 つ後ろの位置を参照するイテレータを取得できる. <code>cend</code>メンバ関数は<code>end</code>メンバ関数の<code>const</code>版である.</li>
<li><code>get_tzdb_list</code>非メンバ関数によって, 同リストの参照を得ることができる. 同メンバ関数への呼び出しがデータベースへの最初のアクセスである場合, データベースを初期化する. この呼び出しによってデータベースが初期化された場合, <code>tzdb</code>を一つ持つ<code>tzdb_list</code>が構築される. 同メンバ関数を一度に複数のスレッドから呼び出しても競合せず, スレッドセーフである. 何らかの理由で有効なリストの参照を返せず, 1 つ以上の有効な<code>tzdb</code>を含む場合, <code>runtime_error</code>例外を送出する.</li>
<li><code>get_tzdb</code>非メンバ関数によって, 同リストの先頭<code>tzdb</code>の参照を得ることができる(<code>get_tzdb_list().front()</code>).</li>
<li><code>locate_zone</code>非メンバ関数によって, 次の値を得ることができる. なお, これがデータベースへの最初のアクセスである場合, データベースを初期化する. <code>get_tzdb().locate_zone(tz_name);</code></li>
<li><code>current_zone</code>非メンバ関数によって, 次の値を得ることができる. <code>get_tzdb().current_zone();</code></li>
</ul></li>
</ul>
<i>ローカル</i>タイムゾーンデータベースは、アプリケーションがデータベースに最初にアクセスするとき, たとえば<code>current_zone()</code>を介して実装によって提供される. アプリケーションが実行されている間, 実装はタイムゾーンデータベースの更新を選択することがある. このアップデートは, アプリケーションによって次に挙げる関数を呼び出さない限り, アプリケーションに影響を与えることはない. この潜在的に更新されたタイムゾーンデータベースは, <i>リモート</i>タイムゾーンデータベースと呼ぶ. <em onclick="obj=document.getElementById(&#39;openremotetimezone&#39;).style; obj.display=(obj.display==&#39;none&#39;)?&#39;block&#39;:&#39;none&#39;;"> <a style="font-style: normal; cursor:pointer;">次のように定義される(クリックで展開).</a> </em>
<div id="openremotetimezone" style="display:none;clear:both;">
<div class="sourceCode" id="cb17"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb17-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb17-1" aria-hidden="true"></a><span class="kw">namespace</span> std { <span class="kw">namespace</span> chrono {</span>
<span id="cb17-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb17-2" aria-hidden="true"></a></span>
<span id="cb17-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb17-3" aria-hidden="true"></a><span class="at">const</span> tzdb&amp; reload_tzdb();</span>
<span id="cb17-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb17-4" aria-hidden="true"></a>string remote_version();</span>
<span id="cb17-5"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb17-5" aria-hidden="true"></a></span>
<span id="cb17-6"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb17-6" aria-hidden="true"></a>} }</span></code></pre></div>
</div>
<ul>
<li><code>reload_tzdb</code>非メンバ関数は, 最初にリモートタイムゾーンデータベースのチェックを行い, ローカルデータベースとリモートデータベースのバージョンが同じである場合はなにもしない. それ以外の場合, リモートデータベースは, <code>get_tzdb_list</code>非メンバ関数によってアクセスされる<code>tzdb_list</code>の先頭にプッシュされる. いずれの場合も, <code>get_tzdb_list().front()</code> が返される. この関数は, <code>get_tzdb_list().front()</code>と<code>get_tzdb_list().erase_after()</code>に対してスレッドセーフである. 何らかの理由で有効な<code>tzdb</code>の参照が戻されない場合, <code>runtime_error</code>例外が送出される.</li>
<li><code>remote_version</code>非メンバ関数は, 最新のリモートデータベースバージョンの文字列(<code>std::string</code>)を返す. リモートバージョンが利用できない場合, 空の文字列が返される. 空でない場合, これを<code>get_tzdb_list().version</code>と比較して, ローカルデータベースとリモートデータベースが同等かどうかをチェックできる.</li>
</ul>
<code>zoned_traits</code>, <code>zoned_time</code>を利用することで, <code>sys_days</code>, <code>local_days</code>といった<code>time_point</code>を<code>tzdb</code>データベースと関連付けることができる. <em onclick="obj=document.getElementById(&#39;openzoned_traits&#39;).style; obj.display=(obj.display==&#39;none&#39;)?&#39;block&#39;:&#39;none&#39;;"> <a style="font-style: normal; cursor:pointer;">次のように定義される(クリックで展開).</a> </em>
<div id="openzoned_traits" style="display:none;clear:both;">
<div class="sourceCode" id="cb18"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb18-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb18-1" aria-hidden="true"></a><span class="kw">namespace</span> std { <span class="kw">namespace</span> chrono {</span>
<span id="cb18-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb18-2" aria-hidden="true"></a></span>
<span id="cb18-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb18-3" aria-hidden="true"></a><span class="kw">template</span> &lt;<span class="kw">class</span> T&gt; <span class="kw">struct</span> zoned_traits {};</span>
<span id="cb18-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb18-4" aria-hidden="true"></a><span class="kw">template</span> &lt;&gt;</span>
<span id="cb18-5"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb18-5" aria-hidden="true"></a><span class="kw">struct</span> zoned_traits&lt;<span class="at">const</span> time_zone*&gt; {</span>
<span id="cb18-6"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb18-6" aria-hidden="true"></a>    <span class="at">static</span> <span class="at">const</span> time_zone* default_zone();</span>
<span id="cb18-7"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb18-7" aria-hidden="true"></a>    <span class="at">static</span> <span class="at">const</span> time_zone* locate_zone(string_view name);</span>
<span id="cb18-8"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb18-8" aria-hidden="true"></a>};</span>
<span id="cb18-9"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb18-9" aria-hidden="true"></a></span>
<span id="cb18-10"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb18-10" aria-hidden="true"></a>} }</span></code></pre></div>
</div>
<p><code>zoned_traits</code>によって, <code>zoned_time</code>のデフォルトコンストラクタの動作をカスタマイズすることができる.</p>
<ul>
<li><code>zoned_traits&lt;const time_zone*&gt;::default_zone();</code> は, <code>std::chrono::locate_zone(&quot;UTC&quot;)</code> を返す.</li>
<li><code>zoned_traits&lt;const time_zone*&gt;::locate_zone(string_view name);</code> は, <code>std::chrono::locate_zone(name)</code> を返す.</li>
</ul>
<code>zoned_time</code>は, <code>Duration</code>の精度で, <code>time_zone</code>と<code>time_point</code>の論理区切りを表す. <i>Strong equality</i><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a>を満たす. <em onclick="obj=document.getElementById(&#39;openzoned_time&#39;).style; obj.display=(obj.display==&#39;none&#39;)?&#39;block&#39;:&#39;none&#39;;"> <a style="font-style: normal; cursor:pointer;">次のように定義される(クリックで展開).</a> </em>
<div id="openzoned_time" style="display:none;clear:both;">
<div class="sourceCode" id="cb19"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb19-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-1" aria-hidden="true"></a><span class="kw">template</span> &lt;<span class="kw">class</span> Duration, <span class="kw">class</span> TimeZonePtr = <span class="at">const</span> time_zone*&gt;</span>
<span id="cb19-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-2" aria-hidden="true"></a><span class="kw">class</span> zoned_time {</span>
<span id="cb19-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-3" aria-hidden="true"></a><span class="kw">public</span>:</span>
<span id="cb19-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-4" aria-hidden="true"></a>    <span class="kw">using</span> duration = <span class="dt">common_type_t</span>&lt;Duration, seconds&gt;;</span>
<span id="cb19-5"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-5" aria-hidden="true"></a></span>
<span id="cb19-6"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-6" aria-hidden="true"></a><span class="kw">private</span>:</span>
<span id="cb19-7"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-7" aria-hidden="true"></a>    TimeZonePtr        <span class="va">zone_</span>;  <span class="co">// exposition only</span></span>
<span id="cb19-8"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-8" aria-hidden="true"></a>    sys_time&lt;duration&gt; <span class="va">tp_</span>;    <span class="co">// exposition only</span></span>
<span id="cb19-9"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-9" aria-hidden="true"></a></span>
<span id="cb19-10"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-10" aria-hidden="true"></a><span class="kw">public</span>:</span>
<span id="cb19-11"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-11" aria-hidden="true"></a>    zoned_time();</span>
<span id="cb19-12"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-12" aria-hidden="true"></a>    zoned_time(<span class="at">const</span> zoned_time&amp;) = <span class="cf">default</span>;</span>
<span id="cb19-13"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-13" aria-hidden="true"></a>    zoned_time&amp; <span class="kw">operator</span>=(<span class="at">const</span> zoned_time&amp;) = <span class="cf">default</span>;</span>
<span id="cb19-14"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-14" aria-hidden="true"></a></span>
<span id="cb19-15"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-15" aria-hidden="true"></a>             zoned_time(<span class="at">const</span> sys_time&lt;Duration&gt;&amp; st);</span>
<span id="cb19-16"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-16" aria-hidden="true"></a>    <span class="kw">explicit</span> zoned_time(TimeZonePtr z);</span>
<span id="cb19-17"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-17" aria-hidden="true"></a>    <span class="kw">explicit</span> zoned_time(string_view name);</span>
<span id="cb19-18"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-18" aria-hidden="true"></a></span>
<span id="cb19-19"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-19" aria-hidden="true"></a>    <span class="kw">template</span> &lt;<span class="kw">class</span> Duration2&gt;</span>
<span id="cb19-20"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-20" aria-hidden="true"></a>        zoned_time(<span class="at">const</span> zoned_time&lt;Duration2&gt;&amp; zt) <span class="kw">noexcept</span>;</span>
<span id="cb19-21"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-21" aria-hidden="true"></a></span>
<span id="cb19-22"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-22" aria-hidden="true"></a>    zoned_time(TimeZonePtr z,    <span class="at">const</span> sys_time&lt;Duration&gt;&amp; st);</span>
<span id="cb19-23"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-23" aria-hidden="true"></a>    zoned_time(string_view name, <span class="at">const</span> sys_time&lt;Duration&gt;&amp; st);</span>
<span id="cb19-24"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-24" aria-hidden="true"></a></span>
<span id="cb19-25"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-25" aria-hidden="true"></a>    zoned_time(TimeZonePtr z,    <span class="at">const</span> local_time&lt;Duration&gt;&amp; tp);</span>
<span id="cb19-26"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-26" aria-hidden="true"></a>    zoned_time(string_view name, <span class="at">const</span> local_time&lt;Duration&gt;&amp; tp);</span>
<span id="cb19-27"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-27" aria-hidden="true"></a>    zoned_time(TimeZonePtr z,    <span class="at">const</span> local_time&lt;Duration&gt;&amp; tp, choose c);</span>
<span id="cb19-28"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-28" aria-hidden="true"></a>    zoned_time(string_view name, <span class="at">const</span> local_time&lt;Duration&gt;&amp; tp, choose c);</span>
<span id="cb19-29"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-29" aria-hidden="true"></a></span>
<span id="cb19-30"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-30" aria-hidden="true"></a>    <span class="kw">template</span> &lt;<span class="kw">class</span> Duration2, <span class="kw">class</span> TimeZonePtr2&gt;</span>
<span id="cb19-31"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-31" aria-hidden="true"></a>        zoned_time(TimeZonePtr z, <span class="at">const</span> zoned_time&lt;Duration2, TimeZonePtr2&gt;&amp; zt);</span>
<span id="cb19-32"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-32" aria-hidden="true"></a>    <span class="kw">template</span> &lt;<span class="kw">class</span> Duration2, <span class="kw">class</span> TimeZonePtr2&gt;</span>
<span id="cb19-33"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-33" aria-hidden="true"></a>        zoned_time(TimeZonePtr z, <span class="at">const</span> zoned_time&lt;Duration2, TimeZonePtr2&gt;&amp; zt, choose);</span>
<span id="cb19-34"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-34" aria-hidden="true"></a></span>
<span id="cb19-35"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-35" aria-hidden="true"></a>    zoned_time(string_view name, <span class="at">const</span> zoned_time&lt;Duration&gt;&amp; zt);</span>
<span id="cb19-36"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-36" aria-hidden="true"></a>    zoned_time(string_view name, <span class="at">const</span> zoned_time&lt;Duration&gt;&amp; zt, choose);</span>
<span id="cb19-37"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-37" aria-hidden="true"></a></span>
<span id="cb19-38"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-38" aria-hidden="true"></a>    zoned_time&amp; <span class="kw">operator</span>=(<span class="at">const</span> sys_time&lt;Duration&gt;&amp; st);</span>
<span id="cb19-39"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-39" aria-hidden="true"></a>    zoned_time&amp; <span class="kw">operator</span>=(<span class="at">const</span> local_time&lt;Duration&gt;&amp; ut);</span>
<span id="cb19-40"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-40" aria-hidden="true"></a></span>
<span id="cb19-41"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-41" aria-hidden="true"></a>             <span class="kw">operator</span> sys_time&lt;duration&gt;()   <span class="at">const</span>;</span>
<span id="cb19-42"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-42" aria-hidden="true"></a>    <span class="kw">explicit</span> <span class="kw">operator</span> local_time&lt;duration&gt;() <span class="at">const</span>;</span>
<span id="cb19-43"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-43" aria-hidden="true"></a></span>
<span id="cb19-44"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-44" aria-hidden="true"></a>    TimeZonePtr          get_time_zone()  <span class="at">const</span>;</span>
<span id="cb19-45"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-45" aria-hidden="true"></a>    local_time&lt;duration&gt; get_local_time() <span class="at">const</span>;</span>
<span id="cb19-46"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-46" aria-hidden="true"></a>    sys_time&lt;duration&gt;   get_sys_time()   <span class="at">const</span>;</span>
<span id="cb19-47"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-47" aria-hidden="true"></a>    sys_info             get_info()       <span class="at">const</span>;</span>
<span id="cb19-48"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb19-48" aria-hidden="true"></a>};</span></code></pre></div>
</div>
<ul>
<li>invariant な<code>zoned_time&lt;Duration&gt;</code>は常に有効な<code>time_zone</code>を参照し, 曖昧でない時間を表す.</li>
<li>デフォルコンストラクタは, <code>zone_</code>を<code>zoned_traits::default_zone()</code>で初期化し, <code>tp_</code>をデフォルト構築して<code>zoned_time</code>を構築する.</li>
<li>コピーコンストラクタは, 関連する<code>time_zone</code>を転送する. <code>Duration</code>が<code>noexcept</code>コピーコンストラクタである場合, <code>zoned_time&lt;Duration&gt;</code>は<code>noexcept</code>コピーコンストラクタである.</li>
<li><code>zoned_time(const sys_time&lt;Duration&gt;&amp; st)</code>: <code>zone_</code>を<code>zoned_traits::default_zone</code>で初期化し, <code>tp_</code>を<code>st</code>で初期化して<code>zoned_time</code>を構築する.</li>
<li><code>zoned_time(TimeZonePtr z)</code>: <code>std::move(z)</code>で<code>zone_</code>を初期化し, <code>zoned_time</code>を構築する. このとき, <code>z</code>は有効な<code>time_zone</code>を指していなければならない.</li>
<li><code>zoned_time(string_view name)</code>: <code>zoned_traits::locate_zone(name)</code>で<code>zone_</code>を初期化し, <code>tp_</code>をデフォルト構築して<code>zoned_time</code>を構築する.</li>
<li><code>zoned_time(const zoned_time&lt;Duration2, TimeZonePtr&gt;&amp; y) noexcept</code>: <code>x == y</code>となる<code>zoned_time</code>, <code>x</code>を構築する.</li>
<li><code>zoned_time(TimeZonePtr z, const sys_time&lt;Duration&gt;&amp; st)</code>: <code>zone_</code>を<code>std::move(z)</code>で初期化し, <code>tp_</code>を<code>st</code>で初期化して<code>zoned_time</code>を構築する. このとき, <code>z</code>は有効な<code>time_zone</code>を指していなければならない.</li>
<li><code>zoned_time(string_view name, const sys_time&lt;Duration&gt;&amp; st)</code>: <code>{zoned_traits&lt;TimeZonePtr&gt;::locate_zone(name), st}</code>と同等の構築を行う.</li>
<li><code>zoned_time(TimeZonePtr z, const local_time&lt;Duration&gt;&amp; tp)</code>: <code>zone_</code>を<code>std::move(z)</code>で初期化し, <code>tp_</code>を<code>zone_-&gt;to_sys(t)</code>で初期化して<code>zoned_time</code>を構築する. このとき, <code>z</code>は有効な<code>time_zone</code>を指していなければならない.</li>
<li><code>zoned_time(string_view name, const local_time&lt;Duration&gt;&amp; tp)</code>: <code>{zoned_traits&lt;TimeZonePtr&gt;::locate_zone(name), tp}</code>と同等の構築を行う.</li>
<li><code>zoned_time(TimeZonePtr z, const local_time&lt;Duration&gt;&amp; tp, choose c)</code>: <code>zoned_</code>を<code>std::moev(z)</code>で初期化し, <code>tp</code>を<code>zone_-&gt;to_sys(t, c)</code>で初期化して<code>zoned_time</code>を構築する. このとき, <code>z</code>は有効な<code>time_zone</code>を指していなければならない.</li>
<li><code>zoned_time(string_view name, const local_time&lt;Duration&gt;&amp; tp, choose c)</code>: <code>{zoned_traits&lt;TimeZonePtr&gt;::locate_zone(name), tp, c}</code>と同等の構築を行う.</li>
<li><code>zoned_time(TimeZonePtr z, const zoned_time&lt;Duration2, TimeZonePtr2&gt;&amp; y)</code>: <code>zone_</code>を<code>std::move(z)</code>で初期化し, <code>tp_</code>を<code>z.tp_</code>で初期化して<code>zoned_time</code>を構築する. このとき, <code>z</code>は有効な<code>time_zone</code>を指していなければならない.</li>
<li><code>zoned_time(TimeZonePtr z, const zoned_time&lt;Duration2, TimeZonePtr2&gt;&amp; y, choose)</code>: <code>{z, y}</code>と同等の構築を行う. このとき, <code>z</code>は有効な<code>time_zone</code>を指していなければならない. <code>choose</code>パラメータを渡すことができるが, これによって挙動が変わることはない.</li>
<li><code>zoned_time(string_view name, const zoned_time&lt;Duration&gt;&amp; y)</code>: <code>{zoned_traits&lt;TimeZonePtr&gt;::locate_zone(name), y}</code>と同等の構築を行う.</li>
<li><code>zoned_time(string_view name, const zoned_time&lt;Duration&gt;&amp; y, choose c)</code>: <code>{locate_zone(name), y, c}</code>と同等の構築を行う. <code>choose</code>パラメータを渡すことができるが, これによって挙動が変わることはない.</li>
<li><code>operator=(const local_time&lt;Duration&gt;&amp; lt)</code>: 代入後, <code>get_local_time() == lt</code>となるよう代入し<code>*this</code>を返す. この代入は, <code>get_time_zone</code>の戻り値には影響しない.</li>
<li><code>operator sys_time&lt;duration&gt;() const</code>: <code>get_sys_time()</code>を返す.</li>
<li><code>operator local_time&lt;duration&gt;() const</code>: <code>get_local_time()</code> を返す.</li>
<li><code>get_time_zone</code>メンバ関数によって, <code>zone_</code>のポインタを取得できる.</li>
<li><code>get_local_time</code>メンバ関数によって, 構築時に設定されたタイムゾーンでの<code>local_time</code>オブジェクトを取得できる(<code>retunr zone_-&gt;to_local(tp_);</code>).</li>
<li><code>get_sys_time</code>メンバ関数によって, 構築時に設定されたタイムゾーンでの<code>sys_time</code>オブジェクトを取得できる(<code>return tp_;</code>).</li>
<li><code>get_info</code>メンバ関数によって, 構築時に設定されたタイムゾーンでの<code>sys_info</code>オブジェクトを取得できる(<code>return zone_-&gt;get_info(tp_);</code>).</li>
</ul>
<p>同ライブラリを利用して, 例えば次のように, ある日時の東京の時間帯を得ることができる<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb20-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb20-1" aria-hidden="true"></a><span class="kw">auto</span> tp1 = <span class="bu">std::</span>chrono<span class="bu">::</span>sys_days{<span class="dv">2016</span><span class="bu">y</span>/May/<span class="dv">29</span><span class="bu">d</span>} + <span class="dv">7</span><span class="bu">h</span> + <span class="dv">30</span><span class="bu">min</span> + <span class="dv">6</span><span class="bu">s</span> + <span class="dv">153</span><span class="bu">ms</span>; <span class="co">// 2016-05-29 07:30:06.153 UTC</span></span>
<span id="cb20-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb20-2" aria-hidden="true"></a><span class="bu">std::</span>chrono<span class="bu">::</span>zoned_time zt1 = {<span class="st">&quot;Asia/Tokyo&quot;</span>, tp1};</span>
<span id="cb20-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb20-3" aria-hidden="true"></a><span class="bu">std::</span>cout &lt;&lt; zt1 &lt;&lt; <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>; <span class="co">// 2016-05-29 16:30:06.153 JST</span></span>
<span id="cb20-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb20-4" aria-hidden="true"></a></span>
<span id="cb20-5"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb20-5" aria-hidden="true"></a><span class="kw">auto</span> tp2 = <span class="bu">std::</span>chrono<span class="bu">::</span>local_days{<span class="dv">2016</span><span class="bu">y</span>/May/<span class="dv">29</span><span class="bu">d</span>} + <span class="dv">7</span><span class="bu">h</span> + <span class="dv">30</span><span class="bu">min</span> + <span class="dv">6</span><span class="bu">s</span> + <span class="dv">153</span><span class="bu">ms</span>; <span class="co">// 2016-05-29 07:30:06.153 JTC</span></span>
<span id="cb20-6"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb20-6" aria-hidden="true"></a><span class="kw">auto</span> zt2 = <span class="bu">std::</span>chrono<span class="bu">::</span>zoned_time{<span class="st">&quot;Asia/Tokyo&quot;</span>, tp2};</span>
<span id="cb20-7"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb20-7" aria-hidden="true"></a><span class="bu">std::</span>cout &lt;&lt; zt &lt;&lt; <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>; <span class="co">// 2016-05-29 07:30:06.153 JST</span></span></code></pre></div>
<code>leap</code>は, タイムゾーンデータベースの初期化時に構築され, タイムゾーンデータベースに格納されるクラスであり, 主に閏秒を扱うクラスである. 同クラスは, <i>Strong ordering</i><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a>を満たす. <em onclick="obj=document.getElementById(&#39;openclassleap&#39;).style; obj.display=(obj.display==&#39;none&#39;)?&#39;block&#39;:&#39;none&#39;;"> <a style="font-style: normal; cursor:pointer;">次のように定義される(クリックで展開).</a> </em>
<div id="openclassleap" style="display:none;clear:both;">
<div class="sourceCode" id="cb21"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb21-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb21-1" aria-hidden="true"></a><span class="kw">class</span> leap</span>
<span id="cb21-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb21-2" aria-hidden="true"></a>{</span>
<span id="cb21-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb21-3" aria-hidden="true"></a>    sys_seconds <span class="va">date_</span>;  <span class="co">// exposition only</span></span>
<span id="cb21-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb21-4" aria-hidden="true"></a><span class="kw">public</span>:</span>
<span id="cb21-5"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb21-5" aria-hidden="true"></a>    leap(<span class="at">const</span> leap&amp;)            = <span class="cf">default</span>;</span>
<span id="cb21-6"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb21-6" aria-hidden="true"></a>    leap&amp; <span class="kw">operator</span>=(<span class="at">const</span> leap&amp;) = <span class="cf">default</span>;</span>
<span id="cb21-7"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb21-7" aria-hidden="true"></a></span>
<span id="cb21-8"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb21-8" aria-hidden="true"></a>    <span class="co">// Undocumented constructors</span></span>
<span id="cb21-9"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb21-9" aria-hidden="true"></a>    sys_seconds date() <span class="at">const</span>;</span>
<span id="cb21-10"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb21-10" aria-hidden="true"></a>};</span></code></pre></div>
</div>
<ul>
<li><code>date</code>メンバ関数によって, <code>date_</code>を取得できる. <code>date_</code>には閏秒挿入の日付が格納されている.</li>
<li>閏秒挿入の全ての日付を<code>for (auto&amp; l : get_tzdb().leaps) std::cout &lt;&lt; l.date() &lt;&lt; &#39;\n&#39;;</code>で確認できる.</li>
</ul>
<p>またタイムゾーンデータベースの構築時に作成される, <code>time_zone</code>の代替名を表現する<code>link</code>というクラスも提供される.</p>
<h3 id="clock">Clock</h3>
<p>新たに <code>utc_clock</code>, <code>tai_clock</code>, <code>gps_clock</code>, <code>file_clock</code> の 4 つのクロック, また, その<code>time_point</code>型のエイリアス(<code>utc_time</code>, <code>utc_seconds</code>, <code>tai_time</code>, <code>tai_seconds</code>, <code>gps_time</code>, <code>gps_seconds</code>) が提供される.</p>
<ul>
<li><code>utc_clock</code> は, 協定世界時(UTC)を表現するクロックであり, 1970 年 1 月 1 日木曜日午後 00:00:00 分からの時間を測定する. これには, 閏秒が含まれる.</li>
<li><code>tai_clock</code>は, 国際原始時計(TAI)を表現するクロックであり, 1958 年 1 月 1 日 00:00:00 からの時間を測定し, この日の UTC(1957-12-31 23:59:50 UTC)よりも 10 秒前にオフセットされている. これには, 閏秒が含まれない<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn20" class="footnote-ref" id="fnref20" role="doc-noteref"><sup>20</sup></a>.</li>
<li><code>gps_clock</code>は GPS 時刻を表現するクロックであり, UTC 1980 年 1 月 6 日 00:00:00 からの時間を測定する. 閏秒は含まれない<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn21" class="footnote-ref" id="fnref21" role="doc-noteref"><sup>21</sup></a>.</li>
<li><code>file_clock</code>は, C++20 で追加されたエイリアス, <code>using file_time_type = std::chrono::time_point&lt;std::chrono::file_clock&gt;;</code>で利用されるファイルクロックである<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fn22" class="footnote-ref" id="fnref22" role="doc-noteref"><sup>22</sup></a>.</li>
</ul>
<h2 id="試用">試用</h2>
<p>同ライブラリを利用した任意月のカレンダーを出力するプログラムは, <a href="http://d.hatena.ne.jp/yohhoy/20180322/p1" target="_blank" rel="nofollow noopener">既にあった</a>のだが, 特別何か別のものは思いつかないので, とりあえず, 任意年の全ての月のカレンダーを出力するプログラムを書いて試用.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb22-1"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-1" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb22-2"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;array&gt;</span></span>
<span id="cb22-3"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-3" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;chrono&gt;</span></span>
<span id="cb22-4"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb22-5"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-5" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;iomanip&gt;</span></span>
<span id="cb22-6"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;utility&gt;</span></span>
<span id="cb22-7"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-7" aria-hidden="true"></a></span>
<span id="cb22-8"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-8" aria-hidden="true"></a><span class="kw">namespace</span> ns {</span>
<span id="cb22-9"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-9" aria-hidden="true"></a></span>
<span id="cb22-10"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-10" aria-hidden="true"></a><span class="kw">template</span> &lt;<span class="kw">class</span>&gt; <span class="kw">struct</span> weeks_init;</span>
<span id="cb22-11"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-11" aria-hidden="true"></a><span class="kw">template</span> &lt;<span class="bu">std::</span>size_t... s&gt;</span>
<span id="cb22-12"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-12" aria-hidden="true"></a><span class="kw">struct</span> weeks_init&lt;<span class="bu">std::</span>index_sequence&lt;s...&gt;&gt; {</span>
<span id="cb22-13"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-13" aria-hidden="true"></a>    <span class="kw">constexpr</span> weeks_init() = <span class="cf">default</span>;</span>
<span id="cb22-14"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-14" aria-hidden="true"></a>    <span class="kw">constexpr</span> <span class="bu">std::</span>array&lt;<span class="bu">std::</span>chrono<span class="bu">::</span>weekday, <span class="kw">sizeof</span>...(s)&gt; <span class="kw">operator</span>()() <span class="at">const</span> <span class="kw">noexcept</span> { <span class="cf">return</span> {{ <span class="bu">std::</span>chrono<span class="bu">::</span>weekday{s}... }}; }</span>
<span id="cb22-15"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-15" aria-hidden="true"></a>};</span>
<span id="cb22-16"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-16" aria-hidden="true"></a><span class="kw">constexpr</span> <span class="kw">auto</span> weeks = weeks_init&lt;<span class="bu">std::</span>make_index_sequence&lt;<span class="dv">7</span>&gt;&gt;()();</span>
<span id="cb22-17"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-17" aria-hidden="true"></a></span>
<span id="cb22-18"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-18" aria-hidden="true"></a><span class="kw">inline</span> <span class="dt">void</span> print_weeks(<span class="bu">std::</span>ostream&amp; os)</span>
<span id="cb22-19"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-19" aria-hidden="true"></a>{</span>
<span id="cb22-20"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-20" aria-hidden="true"></a>    <span class="kw">namespace</span> sc = <span class="bu">std::</span>chrono;</span>
<span id="cb22-21"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-21" aria-hidden="true"></a>    <span class="bu">std::</span>copy(<span class="bu">std::</span>begin(weeks), <span class="bu">std::</span>end(weeks), <span class="bu">std::</span>ostream_iterator&lt;sc::weekday&gt;(os, <span class="st">&quot;  &quot;</span>));</span>
<span id="cb22-22"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-22" aria-hidden="true"></a>    os &lt;&lt; <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>;</span>
<span id="cb22-23"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-23" aria-hidden="true"></a>}</span>
<span id="cb22-24"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-24" aria-hidden="true"></a></span>
<span id="cb22-25"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-25" aria-hidden="true"></a>} <span class="co">// namespace ns</span></span>
<span id="cb22-26"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-26" aria-hidden="true"></a></span>
<span id="cb22-27"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-27" aria-hidden="true"></a><span class="kw">struct</span> print_calendar_year {</span>
<span id="cb22-28"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-28" aria-hidden="true"></a>    <span class="kw">explicit</span> <span class="kw">constexpr</span> print_calendar_year(<span class="bu">std::</span>chrono<span class="bu">::</span>year y) <span class="kw">noexcept</span></span>
<span id="cb22-29"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-29" aria-hidden="true"></a>        : <span class="va">y_</span>(y) {}</span>
<span id="cb22-30"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-30" aria-hidden="true"></a></span>
<span id="cb22-31"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-31" aria-hidden="true"></a>    <span class="kw">friend</span> <span class="bu">std::</span>ostream&amp; <span class="kw">operator</span>&lt;&lt;(<span class="bu">std::</span>ostream&amp; os, <span class="at">const</span> print_calendar_year&amp; <span class="va">this_</span>)</span>
<span id="cb22-32"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-32" aria-hidden="true"></a>    {</span>
<span id="cb22-33"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-33" aria-hidden="true"></a>        <span class="kw">using</span> <span class="kw">namespace</span> <span class="bu">std::</span>chrono_literals;</span>
<span id="cb22-34"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-34" aria-hidden="true"></a>        <span class="kw">namespace</span> sc = <span class="bu">std::</span>chrono;</span>
<span id="cb22-35"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-35" aria-hidden="true"></a>        <span class="kw">constexpr</span> <span class="dt">int</span> width = <span class="dv">5</span>;</span>
<span id="cb22-36"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-36" aria-hidden="true"></a></span>
<span id="cb22-37"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-37" aria-hidden="true"></a>        <span class="cf">for</span> (<span class="dt">unsigned</span> i = <span class="dv">1</span><span class="bu">u</span>, uweek = <span class="kw">static_cast</span>&lt;<span class="dt">unsigned</span>&gt;(sc::weekday{sc::sys_days{<span class="va">this_</span>.<span class="va">y_</span>/sc::January/<span class="dv">1</span><span class="bu">d</span>}}); i &lt;= <span class="dv">12</span><span class="bu">u</span>; ++i) {</span>
<span id="cb22-38"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-38" aria-hidden="true"></a>            <span class="kw">auto</span> lastday = (<span class="va">this_</span>.<span class="va">y_</span>/sc::month{i}/sc::last).day();</span>
<span id="cb22-39"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-39" aria-hidden="true"></a>            os &lt;&lt; <span class="bu">std::</span>setw(ns::weeks.size() * width / <span class="dv">2</span>) &lt;&lt; sc::month{i} &lt;&lt; <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>;</span>
<span id="cb22-40"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-40" aria-hidden="true"></a>            ns::print_weeks(os &lt;&lt; <span class="bu">std::</span>setw(width));</span>
<span id="cb22-41"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-41" aria-hidden="true"></a></span>
<span id="cb22-42"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-42" aria-hidden="true"></a>            <span class="dt">unsigned</span> k = <span class="dv">0</span>;</span>
<span id="cb22-43"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-43" aria-hidden="true"></a>            <span class="cf">for</span> (; k &lt; uweek; ++k) os &lt;&lt; <span class="bu">std::</span>setw(width) &lt;&lt; <span class="st">&quot; &quot;</span>;</span>
<span id="cb22-44"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-44" aria-hidden="true"></a>            <span class="cf">for</span> (sc::day d{<span class="dv">1</span>}; d &lt;= lastday; ++d) {</span>
<span id="cb22-45"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-45" aria-hidden="true"></a>                os &lt;&lt; <span class="bu">std::</span>setw(width) &lt;&lt; <span class="kw">static_cast</span>&lt;<span class="dt">unsigned</span>&gt;(d);</span>
<span id="cb22-46"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-46" aria-hidden="true"></a>                <span class="cf">if</span> (++k &gt; <span class="dv">6</span>) {</span>
<span id="cb22-47"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-47" aria-hidden="true"></a>                    k = <span class="dv">0</span>;</span>
<span id="cb22-48"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-48" aria-hidden="true"></a>                    os &lt;&lt; <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>;</span>
<span id="cb22-49"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-49" aria-hidden="true"></a>                }</span>
<span id="cb22-50"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-50" aria-hidden="true"></a>            }</span>
<span id="cb22-51"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-51" aria-hidden="true"></a>            <span class="cf">if</span> (k) os &lt;&lt; <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>;</span>
<span id="cb22-52"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-52" aria-hidden="true"></a>            uweek = k;</span>
<span id="cb22-53"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-53" aria-hidden="true"></a>        }</span>
<span id="cb22-54"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-54" aria-hidden="true"></a>        <span class="cf">return</span> os;</span>
<span id="cb22-55"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-55" aria-hidden="true"></a>    }</span>
<span id="cb22-56"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-56" aria-hidden="true"></a><span class="kw">private</span>:</span>
<span id="cb22-57"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-57" aria-hidden="true"></a>    <span class="bu">std::</span>chrono<span class="bu">::</span>year <span class="va">y_</span>;</span>
<span id="cb22-58"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-58" aria-hidden="true"></a>};</span>
<span id="cb22-59"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-59" aria-hidden="true"></a></span>
<span id="cb22-60"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-60" aria-hidden="true"></a><span class="dt">int</span> main()</span>
<span id="cb22-61"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-61" aria-hidden="true"></a>{</span>
<span id="cb22-62"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-62" aria-hidden="true"></a>    <span class="bu">std::</span>cout &lt;&lt; print_calendar_year{<span class="bu">std::</span>chrono<span class="bu">::</span>year{<span class="dv">2000</span>}} &lt;&lt; <span class="bu">std::</span>endl;</span>
<span id="cb22-63"><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#cb22-63" aria-hidden="true"></a>}</span></code></pre></div>
<p><a href="https://wandbox.org/permlink/qdkXXRJFNGPTdDg2" target="_blank" rel="nofollow noopener">実行結果</a>. <br></p>
<p>タイムゾーンに関するサンプルは, <a href="https://howardhinnant.github.io/date/tz.html" target="_blank" rel="nofollow noopener">元の実装のドキュメント</a>で多く取り上げられている. フライトタイムの計算や, IANA タイムゾーンデータベースを利用しないカスタムタイムゾーンを作成する例などが掲示されている.</p>
<h2 id="感想">感想</h2>
<ul>
<li>とてもよく作り込まれていて, 使いやすそうに感じる.</li>
<li>C++ にこのような高レベル API が導入されるのは, 少し新鮮.</li>
</ul>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p><a href="https://twitter.com/yohhoy/status/985830560013500416" target="_blank" rel="nofollow noopener">yohhoy</a> さんに<code>last</code>の属する名前空間に関する追加情報を頂いた. ありがとうございます.<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>この一つ前の ISO C++ 委員会による国際会議で C++20 に追加された <a href="http://open-std.org/JTC1/SC22/WG21/docs/papers/2017/p0515r2.pdf" target="_blank" rel="nofollow noopener">P0515 Consistent comparison</a> で挙げられている comparison category types での呼称を用いている. 参照: <a href="https://roki.hateblo.jp/entry/2017/11/27/Consistent/three-way_comparison" target="_blank" rel="nofollow noopener">Consistent/three-way comparison</a><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>この一つ前の ISO C++ 委員会による国際会議で C++20 に追加された <a href="http://open-std.org/JTC1/SC22/WG21/docs/papers/2017/p0515r2.pdf" target="_blank" rel="nofollow noopener">P0515 Consistent comparison</a> で挙げられている comparison category types での呼称を用いている. 参照: <a href="https://roki.hateblo.jp/entry/2017/11/27/Consistent/three-way_comparison" target="_blank" rel="nofollow noopener">Consistent/three-way comparison</a><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>タイムゾーンライブラリの型とその関係性を示した<a href="https://howardhinnant.github.io/date/tz_types.jpeg" target="_blank" rel="nofollow noopener">図</a>を, 作者のドキュメントページから見ることができる.<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5" role="doc-endnote"><p><a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" target="_blank" rel="nofollow noopener">List of tz database time zones</a><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6" role="doc-endnote"><p>サマータイムの開始と終了で, 存在しないローカル時間(<code>nonexistent_local_time</code>)と重複するローカル時間(<code>ambiguous_local_time</code>)という概念が生じる.<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7" role="doc-endnote"><p>サマータイムの開始と終了で, 存在しないローカル時間(<code>nonexistent_local_time</code>)と重複するローカル時間(<code>ambiguous_local_time</code>)という概念が生じる.<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8" role="doc-endnote"><p><a href="https://github.com/HowardHinnant/date" target="_blank" rel="nofollow noopener">元の実装</a>を見ると, 現在地のタイムゾーン取得においては, <a href="https://github.com/HowardHinnant/date/blob/38c5ca38bb73b292b72e088c31595add564d31f6/src/tz.cpp#L321-L372" target="_blank" rel="nofollow noopener">Linux および Mac では特定ファイル(/usr/share/zoneinfo, /usr/share/zoneinfo/uclibc) を読み込み</a>, <a href="https://github.com/HowardHinnant/date/blob/38c5ca38bb73b292b72e088c31595add564d31f6/src/tz.cpp#L3615-L3631" target="_blank" rel="nofollow noopener">Windows ではレジストリ値を読み込んでいる</a>. レジストリ値から取得されたネイティブな現在のタイムゾーン名が標準のものと一致する保証はなく, 特に Windows の場合, 得られる名前は必ず標準と異なるものであるため, 標準の名前と関連づけるマッピングが行われる. 元の実装では, Windows の場合ではタイムゾーンデータベースの取得の際に, <a href="http://unicode.org/repos/cldr/trunk/common/supplemental/windowsZones.xml" target="_blank" rel="nofollow noopener">xml ファイル</a> を<a href="https://github.com/HowardHinnant/date/blob/38c5ca38bb73b292b72e088c31595add564d31f6/src/tz.cpp#L3263-L3271" target="_blank" rel="nofollow noopener">取得している</a>.<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9" role="doc-endnote"><p><a href="https://github.com/HowardHinnant/date" target="_blank" rel="nofollow noopener">元の実装</a>を見ると, OS のタイムゾーンデータベースを利用せず, リモート API があるときは <a href="https://github.com/HowardHinnant/date/blob/38c5ca38bb73b292b72e088c31595add564d31f6/src/tz.cpp#L3243-L3273" target="_blank" rel="nofollow noopener">OS 依存またはサードパーティ製のライブラリを利用してデータを取得</a>し, そうでないとき OS のタイムゾーンデータベースを利用する. <a href="https://github.com/HowardHinnant/date" target="_blank" rel="nofollow noopener">元の実装</a>で OS のタイムゾーンデータベースを試用する際には, <code>DUSE_OS_TZDB=1</code>をセットしてビルドする. Windows 環境がないので筆者にはわからないが, <a href="https://github.com/HowardHinnant/date/blob/e7e1482087f58913b80a20b04d5c58d9d6d90155/CMakeLists.txt#L51" target="_blank" rel="nofollow noopener">Windows では OS のタイムゾーンデータベースを利用できないようだ</a>.<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10" role="doc-endnote"><p>この一つ前の ISO C++ 委員会による国際会議で C++20 に追加された <a href="http://open-std.org/JTC1/SC22/WG21/docs/papers/2017/p0515r2.pdf" target="_blank" rel="nofollow noopener">P0515 Consistent comparison</a> で挙げられている comparison category types での呼称を用いている. 参照: <a href="https://roki.hateblo.jp/entry/2017/11/27/Consistent/three-way_comparison" target="_blank" rel="nofollow noopener">Consistent/three-way comparison</a><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11" role="doc-endnote"><p><a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" target="_blank" rel="nofollow noopener">List of tz database time zones</a><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12" role="doc-endnote"><p>サマータイムの開始と終了で, 存在しないローカル時間(<code>nonexistent_local_time</code>)と重複するローカル時間(<code>ambiguous_local_time</code>)という概念が生じる.<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13" role="doc-endnote"><p>2016-11-06 01:30:00 EDT は, 2016-11-06 05:30:00 UTC と 2016-11-06 06:30:00 UTC になりうる. <code>try { auto zt = zoned_time{&quot;America/New_York&quot;, local_days{Sunday[1]/November/2016} + 1h + 30min}; } catch (const ambiguous_local_time&amp;) { }</code><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14" role="doc-endnote"><p>サマータイムの開始と終了で, 存在しないローカル時間(<code>nonexistent_local_time</code>)と重複するローカル時間(<code>ambiguous_local_time</code>)という概念が生じる.<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15" role="doc-endnote"><p>2016-03-13 02:30:00 EDT は, 2016-03-13 02:00:00 EST と 2016-03-13 03:00:00 EDT の間にあるため存在しない. どちらも, 2016-03-13 07:00:00 UTC と等価である. <code>try { auto zt = zoned_time{&quot;America/New_York&quot;, local_days{Sunday[2]/March/2016} + 2h + 30min}; } catch (const noexistent_local_time&amp;) {}</code><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16" role="doc-endnote"><p>サマータイムの開始と終了で, 存在しないローカル時間(<code>nonexistent_local_time</code>)と重複するローカル時間(<code>ambiguous_local_time</code>)という概念が生じる.<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn17" role="doc-endnote"><p>この一つ前の ISO C++ 委員会による国際会議で C++20 に追加された <a href="http://open-std.org/JTC1/SC22/WG21/docs/papers/2017/p0515r2.pdf" target="_blank" rel="nofollow noopener">P0515 Consistent comparison</a> で挙げられている comparison category types での呼称を用いている. 参照: <a href="https://roki.hateblo.jp/entry/2017/11/27/Consistent/three-way_comparison" target="_blank" rel="nofollow noopener">Consistent/three-way comparison</a><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref17" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn18" role="doc-endnote"><p><a href="https://github.com/HowardHinnant/date" target="_blank" rel="nofollow noopener">元の実装</a>を見ると, OS のタイムゾーンデータベースを利用せず, リモート API があるときは <a href="https://github.com/HowardHinnant/date/blob/38c5ca38bb73b292b72e088c31595add564d31f6/src/tz.cpp#L3243-L3273" target="_blank" rel="nofollow noopener">OS 依存またはサードパーティ製のライブラリを利用してデータを取得</a>し, そうでないとき OS のタイムゾーンデータベースを利用する. <a href="https://github.com/HowardHinnant/date" target="_blank" rel="nofollow noopener">元の実装</a>で OS のタイムゾーンデータベースを試用する際には, <code>DUSE_OS_TZDB=1</code>をセットしてビルドする. Windows 環境がないので筆者にはわからないが, <a href="https://github.com/HowardHinnant/date/blob/e7e1482087f58913b80a20b04d5c58d9d6d90155/CMakeLists.txt#L51" target="_blank" rel="nofollow noopener">Windows では OS のタイムゾーンデータベースを利用できないようだ</a>.<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref18" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn19" role="doc-endnote"><p>この一つ前の ISO C++ 委員会による国際会議で C++20 に追加された <a href="http://open-std.org/JTC1/SC22/WG21/docs/papers/2017/p0515r2.pdf" target="_blank" rel="nofollow noopener">P0515 Consistent comparison</a> で挙げられている comparison category types での呼称を用いている. 参照: <a href="https://roki.hateblo.jp/entry/2017/11/27/Consistent/three-way_comparison" target="_blank" rel="nofollow noopener">Consistent/three-way comparison</a><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref19" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn20" role="doc-endnote"><p>閏秒が UTC に挿入される度に, UTC は TAI の 1 秒遅れとなる. 1961 年発祥の旧 UTC, 1972 年の特別調整, 1972 年から 2017 年 1 月まで行われた27 回の閏秒調整の過程を踏み, UTC は現在 TAI に対して 37 秒遅れている. 参考: <a href="http://jjy.nict.go.jp/mission/page1.html" target="_blank" rel="nofollow noopener">http://jjy.nict.go.jp/mission/page1.html</a><a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref20" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn21" role="doc-endnote"><p><code>tai_clock</code>同様, UTC に閏秒が挿入されるたびに UTC の 1 秒後を表現することとなる. 2017 年時点で, UTC は GPS の 18 秒前 にある. 余談: <a href="https://nyanchew.com/jp/gps%E3%81%AF%E3%81%A9%E3%81%AE%E3%82%88%E3%81%86%E3%81%AB%E3%81%97%E3%81%A6%E3%81%86%E3%82%8B%E3%81%86%E7%A7%92%E3%82%92%E6%8C%BF%E5%85%A5%E3%81%99%E3%82%8B%E3%81%8B" target="_blank" rel="nofollow noopener">GPS が UTC との差分を計算する方法に関して</a>.<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref21" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn22" role="doc-endnote"><p><code>file_time_type</code>は C++17 時点で既にエイリアスとして追加されているが, <code>using file_time_type = std::chrono::time_point&lt;/*trivial-clock*/&gt;;</code>と記されており, 具体的なクロック型は明記されていなかった.<a href="../../../../../roki.log/2018/03/26/cpp_calender_and_timezone_library/#fnref22" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
                </section>
                <hr class="hr" />
                <div class="is-pulled-right">
    <style>
    .social-icon a {
        color: #363636;
    }
    </style>
    <ul class="fa-ul">
        <li class="fa-li is-inline social-icon">
            <a href="http://twitter.com/share?url=https://roki.dev/roki.log/2018/03/26/cpp_calender_and_timezone_library/index.html&amp;text=C++20 Calender and timezone library%20%7C%20roki.dev%2Froki.log&amp;via=530506" rel="nofollow noopener noreferrer" class="social-icon-twitter" target="_blank" rel="nofollow noopener">
                <svg role="img" class="svg-inline--fa fa-square-x-twitter fa-lg" data-icon="square-x-twitter" data-prefix="fab" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm297.1 84L257.3 234.6 379.4 396H283.8L209 298.1 123.3 396H75.8l111-126.9L69.7 116h98l67.7 89.5L313.6 116h47.5zM323.3 367.6L153.4 142.9H125.1L296.9 367.6h26.3z"></path></svg>
            </a>
        </li>
        <li class="fa-li is-inline social-icon">
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://roki.dev/roki.log/2018/03/26/cpp_calender_and_timezone_library/index.html" rel="nofollow noopener noreferrer" class="social-icon-facebook" target="_blank" rel="nofollow noopener">
                <svg role="img" class="svg-inline--fa fa-square-facebook fa-lg" data-icon="square-facebook" data-prefix="fab" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M400 32H48A48 48 0 0 0 0 80v352a48 48 0 0 0 48 48h137.25V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.27c-30.81 0-40.42 19.12-40.42 38.73V256h68.78l-11 71.69h-57.78V480H400a48 48 0 0 0 48-48V80a48 48 0 0 0-48-48z"></path></svg>
            </a>
        </li>
        <li class="fa-li is-inline social-icon">
            <a href="https://social-plugins.line.me/lineit/share?url=https://roki.dev/roki.log/2018/03/26/cpp_calender_and_timezone_library/index.html" rel="nofollow noopener noreferrer" class="social-icon-line" target="_blank" rel="nofollow noopener">
                <svg role="img" class="svg-inline--fa fa-line fa-lg" data-icon="line" data-prefix="fab" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M311 196.8v81.3c0 2.1-1.6 3.7-3.7 3.7h-13c-1.3 0-2.4-.7-3-1.5l-37.3-50.3v48.2c0 2.1-1.6 3.7-3.7 3.7h-13c-2.1 0-3.7-1.6-3.7-3.7V196.9c0-2.1 1.6-3.7 3.7-3.7h12.9c1.1 0 2.4 .6 3 1.6l37.3 50.3V196.9c0-2.1 1.6-3.7 3.7-3.7h13c2.1-.1 3.8 1.6 3.8 3.5zm-93.7-3.7h-13c-2.1 0-3.7 1.6-3.7 3.7v81.3c0 2.1 1.6 3.7 3.7 3.7h13c2.1 0 3.7-1.6 3.7-3.7V196.8c0-1.9-1.6-3.7-3.7-3.7zm-31.4 68.1H150.3V196.8c0-2.1-1.6-3.7-3.7-3.7h-13c-2.1 0-3.7 1.6-3.7 3.7v81.3c0 1 .3 1.8 1 2.5c.7 .6 1.5 1 2.5 1h52.2c2.1 0 3.7-1.6 3.7-3.7v-13c0-1.9-1.6-3.7-3.5-3.7zm193.7-68.1H327.3c-1.9 0-3.7 1.6-3.7 3.7v81.3c0 1.9 1.6 3.7 3.7 3.7h52.2c2.1 0 3.7-1.6 3.7-3.7V265c0-2.1-1.6-3.7-3.7-3.7H344V247.7h35.5c2.1 0 3.7-1.6 3.7-3.7V230.9c0-2.1-1.6-3.7-3.7-3.7H344V213.5h35.5c2.1 0 3.7-1.6 3.7-3.7v-13c-.1-1.9-1.7-3.7-3.7-3.7zM512 93.4V419.4c-.1 51.2-42.1 92.7-93.4 92.6H92.6C41.4 511.9-.1 469.8 0 418.6V92.6C.1 41.4 42.2-.1 93.4 0H419.4c51.2 .1 92.7 42.1 92.6 93.4zM441.6 233.5c0-83.4-83.7-151.3-186.4-151.3s-186.4 67.9-186.4 151.3c0 74.7 66.3 137.4 155.9 149.3c21.8 4.7 19.3 12.7 14.4 42.1c-.8 4.7-3.8 18.4 16.1 10.1s107.3-63.2 146.5-108.2c27-29.7 39.9-59.8 39.9-93.1z"></path></svg>
            </a>
        </li>
        <li class="fa-li is-inline social-icon">
            <a href="https://getpocket.com/edit?url=https://roki.dev/roki.log/2018/03/26/cpp_calender_and_timezone_library/index.html" rel="nofollow noopener noreferrer" class="social-icon-pocket" target="_blank" rel="nofollow noopener">
                <svg role="img" class="svg-inline--fa fa-get-pocket fa-lg" data-icon="get-pocket" data-prefix="fab" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M407.6 64h-367C18.5 64 0 82.5 0 104.6v135.2C0 364.5 99.7 464 224.2 464c124 0 223.8-99.5 223.8-224.2V104.6c0-22.4-17.7-40.6-40.4-40.6zm-162 268.5c-12.4 11.8-31.4 11.1-42.4 0C89.5 223.6 88.3 227.4 88.3 209.3c0-16.9 13.8-30.7 30.7-30.7 17 0 16.1 3.8 105.2 89.3 90.6-86.9 88.6-89.3 105.5-89.3 16.9 0 30.7 13.8 30.7 30.7 0 17.8-2.9 15.7-114.8 123.2z"></path></svg>
            </a>
        </li>
    </ul>
</div>
<div style="is-clear-fix"></div>

                <br />

                <aside class="comments mt-4">
                    <div id="disqus_thread"></div>
                    <script>
                    (function() { 
                        var d = document, s = d.createElement('script');
                        s.src = 'https://roki-log.disqus.com/embed.js';
                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s); 
                    })();
                    </script>
                    <noscript>
                        Please enable JavaScript to view the 
                        <a href="https://roki-log.disqus.com/?ref_noscript" target="_blank" rel="nofollow noopener">
                            comments powered by Disqus.
                        </a>
                    </noscript>
                </aside>

                <div class="container">
                    <div class="card mb-1 is-shadowless" style="background-color: transparent;">
                        <div class="card-content">
                            <nav class="pagination is-centered" role="navigation" aria-label="pagination">
                                
				                <a href="../../../../../roki.log/2018/04/7/hs_pattern_match_complexity/index.html" class="pagination-previous">
                                    <div class="is-inline-block is-valign-middle">
                                        <svg role="img" class="svg-inline--fa fa-angles-left mr-1" data-icon="angles-left" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"></path></svg>
                                    </div>
                                    <div class="is-inline-block is-valign-middle">
                                        <i class="fas fa-calendar-alt mr-1"></i>2018/04/07 16:50:00
                                        <svg role="img" class="svg-inline--fa fa-pencil ml-1 mr-1" data-icon="pencil" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path></svg>ghc パタ...
                                    </div>
                                </a>
                                

                                
				                <a href="../../../../../roki.log/2018/03/22/my_first_post/index.html" class="pagination-next">
                                    <div class="is-inline-block is-valign-middle">
                                        <i class="fas fa-calendar-alt mr-1"></i>2018/03/22 16:50:00
                                        <svg role="img" class="svg-inline--fa fa-pencil ml-1 mr-1" data-icon="pencil" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path></svg>ハローワール...
                                    </div>
                                    <div class="ml-1 is-inline-block is-valign-middle">
                                        <svg role="img" class="svg-inline--fa fa-angles-right" data-icon="angles-right" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M470.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 256 265.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160zm-352 160l160-160c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L210.7 256 73.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0z"></path></svg>
                                    </div>
                                </a>
                                
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </article>
</main>
<footer class="footer">
    <div class="container" style="display: flex; justify-content: center; align-items: center;">
    <figure class="image">
        <img class="footer-dec" />
    </figure>
</div>

    <div class="container mt-3">
        <div class="columns is-multiline">
            <div class="column is-one-quarter">
                <h4 class="title is-5">
                    <svg role="img" class="svg-inline--fa fa-user" data-icon="user" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"></path></svg>
                    About Me
                </h4>
                <figure class="image is-64x64 is-inline-block is-valign-middle" style="align: center;">
                    <picture>
                        <source type="image/webp" class="blured-my-prof-webp" srcset="../../../../../images/avator/prof1000x1000.png.webp"></source>
                        <img class="blured-my-prof is-inline-block mt-0 is-valign-middle" />
                    </picture>
                </figure>
                <div class="is-inline-block is-valign-middle">
                    <h5 class="title is-6 mb-0">
                        <svg role="img" class="svg-inline--fa fa-signature fa-fw" data-icon="signature" data-prefix="fas" viewBox="0 0 640 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M192 128c0-17.7 14.3-32 32-32s32 14.3 32 32v7.8c0 27.7-2.4 55.3-7.1 82.5l-84.4 25.3c-40.6 12.2-68.4 49.6-68.4 92v71.9c0 40 32.5 72.5 72.5 72.5c26 0 50-13.9 62.9-36.5l13.9-24.3c26.8-47 46.5-97.7 58.4-150.5l94.4-28.3-12.5 37.5c-3.3 9.8-1.6 20.5 4.4 28.8s15.7 13.3 26 13.3H544c17.7 0 32-14.3 32-32s-14.3-32-32-32H460.4l18-53.9c3.8-11.3 .9-23.8-7.4-32.4s-20.7-11.8-32.2-8.4L316.4 198.1c2.4-20.7 3.6-41.4 3.6-62.3V128c0-53-43-96-96-96s-96 43-96 96v32c0 17.7 14.3 32 32 32s32-14.3 32-32V128zm-9.2 177l49-14.7c-10.4 33.8-24.5 66.4-42.1 97.2l-13.9 24.3c-1.5 2.6-4.3 4.3-7.4 4.3c-4.7 0-8.5-3.8-8.5-8.5V335.6c0-14.1 9.3-26.6 22.8-30.7zM24 368c-13.3 0-24 10.7-24 24s10.7 24 24 24H64.3c-.2-2.8-.3-5.6-.3-8.5V368H24zm592 48c13.3 0 24-10.7 24-24s-10.7-24-24-24H305.9c-6.7 16.3-14.2 32.3-22.3 48H616z"></path></svg>
                        Roki
                    </h5>
                    <i class="fas fa-question-circle fa-fw"></i>
                    <a href="../../../../../">
                        more info
                    </a>
                </div>
            </div>
            
            <div class="column is-one-quarter">
                <h4 class="title is-5">
                    <svg role="img" class="svg-inline--fa fa-file" data-icon="file" data-prefix="fas" viewBox="0 0 384 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M0 64C0 28.7 28.7 0 64 0H224V128c0 17.7 14.3 32 32 32H384V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V64zm384 64H256V0L384 128z"></path></svg>
                    Recent posts
                </h4>
                <ul>
                    
                    <li>
                        <svg role="img" class="svg-inline--fa fa-pencil" data-icon="pencil" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path></svg>
                        <a href="../../../../../roki.log/2023/11/09/add-new-web-api-send-plain-text/index.html">東京ガスの請求通知を自作 LINE Bot に喋らせる</a>
                    </li>
                    
                    <li>
                        <svg role="img" class="svg-inline--fa fa-pencil" data-icon="pencil" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path></svg>
                        <a href="../../../../../roki.log/2022/04/10/LineBotDevelopment/index.html">簡易認証, 指定時間実行可能な LINE Bot の自作</a>
                    </li>
                    
                    <li>
                        <svg role="img" class="svg-inline--fa fa-pencil" data-icon="pencil" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path></svg>
                        <a href="../../../../../roki.log/2021/07/10/SelfMadeTinyGit/index.html">技術書典 11 にて Git (一部) を自作する記事を執筆した</a>
                    </li>
                    
                    <li>
                        <svg role="img" class="svg-inline--fa fa-pencil" data-icon="pencil" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path></svg>
                        <a href="../../../../../roki.log/2020/12/16/CompileTimeLazyKWithCXXTemplateMetaProgramming/index.html">C++ テンプレートメタプログラミングによるコンパイル時 Lazy K インタプリタ</a>
                    </li>
                    
                    <li>
                        <svg role="img" class="svg-inline--fa fa-pencil" data-icon="pencil" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path></svg>
                        <a href="../../../../../roki.log/2020/08/25/hello-roki-web/index.html">個人ページ, ブログを移行した</a>
                    </li>
                    
                </ul>
            </div>

            <div class="column is-one-quarter">
                <h4 class="title is-5">
                    <svg role="img" class="svg-inline--fa fa-tags" data-icon="tags" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M345 39.1L472.8 168.4c52.4 53 52.4 138.2 0 191.2L360.8 472.9c-9.3 9.4-24.5 9.5-33.9 .2s-9.5-24.5-.2-33.9L438.6 325.9c33.9-34.3 33.9-89.4 0-123.7L310.9 72.9c-9.3-9.4-9.2-24.6 .2-33.9s24.6-9.2 33.9 .2zM0 229.5V80C0 53.5 21.5 32 48 32H197.5c17 0 33.3 6.7 45.3 18.7l168 168c25 25 25 65.5 0 90.5L277.3 442.7c-25 25-65.5 25-90.5 0l-168-168C6.7 262.7 0 246.5 0 229.5zM144 144a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"></path></svg>
                    Categories
                </h4>
                <div class="tags"><span class="tag is-dark"><a href="../../../../../roki.log/tags/aws/index.html"><span>AWS</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/bot/index.html"><span>Bot</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/c/index.html"><span>C++</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/compiler/index.html"><span>Compiler</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/elementary-number-theory/index.html"><span>Elementary number theory</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/git/index.html"><span>Git</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/googleappsscript/index.html"><span>GoogleAppsScript</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/group-theory/index.html"><span>Group theory</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/haskell/index.html"><span>Haskell</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/line/index.html"><span>LINE</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/lazy-k/index.html"><span>Lazy K</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/network/index.html"><span>Network</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/networking/index.html"><span>Networking</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/probability-theory/index.html"><span>Probability theory</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/python/index.html"><span>Python</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/quantum-mechanics/index.html"><span>Quantum mechanics</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/security/index.html"><span>Security</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/emscripten/index.html"><span>emscripten</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/golang/index.html"><span>golang</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/javascript/index.html"><span>javascript</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/math/index.html"><span>math</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/physics/index.html"><span>physics</span></a></span></div>
            </div>

            <div class="column">
                <h4 class="title is-5">
                    <svg role="img" class="svg-inline--fa fa-box-archive" data-icon="box-archive" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M32 32H480c17.7 0 32 14.3 32 32V96c0 17.7-14.3 32-32 32H32C14.3 128 0 113.7 0 96V64C0 46.3 14.3 32 32 32zm0 128H480V416c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V160zm128 80c0 8.8 7.2 16 16 16H336c8.8 0 16-7.2 16-16s-7.2-16-16-16H176c-8.8 0-16 7.2-16 16z"></path></svg>
                    Archive
                </h4>
                <div class="archives">
                <ul class="archive-tree"><li><input id="tree-label-2023" type="checkbox" class="tree-toggle"><label for="tree-label-2023" class="tree-toggle-button"><svg role="img" class="svg-inline--fa fa-angle-right fa-fw" data-icon="angle-right" data-prefix="fas" viewBox="0 0 320 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"></path></svg><svg role="img" class="svg-inline--fa fa-angle-down fa-fw" data-icon="angle-down" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"></path></svg></label><a href="../../../../../roki.log/2023/index.html">2023 (1)</a><ul class="tree-child"><li><a href="../../../../../roki.log/2023/11/index.html">2023/11 (1)</a></li></ul></li><li><input id="tree-label-2022" type="checkbox" class="tree-toggle"><label for="tree-label-2022" class="tree-toggle-button"><svg role="img" class="svg-inline--fa fa-angle-right fa-fw" data-icon="angle-right" data-prefix="fas" viewBox="0 0 320 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"></path></svg><svg role="img" class="svg-inline--fa fa-angle-down fa-fw" data-icon="angle-down" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"></path></svg></label><a href="../../../../../roki.log/2022/index.html">2022 (1)</a><ul class="tree-child"><li><a href="../../../../../roki.log/2022/04/index.html">2022/04 (1)</a></li></ul></li><li><input id="tree-label-2021" type="checkbox" class="tree-toggle"><label for="tree-label-2021" class="tree-toggle-button"><svg role="img" class="svg-inline--fa fa-angle-right fa-fw" data-icon="angle-right" data-prefix="fas" viewBox="0 0 320 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"></path></svg><svg role="img" class="svg-inline--fa fa-angle-down fa-fw" data-icon="angle-down" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"></path></svg></label><a href="../../../../../roki.log/2021/index.html">2021 (1)</a><ul class="tree-child"><li><a href="../../../../../roki.log/2021/07/index.html">2021/07 (1)</a></li></ul></li><li><input id="tree-label-2020" type="checkbox" class="tree-toggle"><label for="tree-label-2020" class="tree-toggle-button"><svg role="img" class="svg-inline--fa fa-angle-right fa-fw" data-icon="angle-right" data-prefix="fas" viewBox="0 0 320 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"></path></svg><svg role="img" class="svg-inline--fa fa-angle-down fa-fw" data-icon="angle-down" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"></path></svg></label><a href="../../../../../roki.log/2020/index.html">2020 (3)</a><ul class="tree-child"><li><a href="../../../../../roki.log/2020/12/index.html">2020/12 (1)</a></li><li><a href="../../../../../roki.log/2020/08/index.html">2020/08 (1)</a></li><li><a href="../../../../../roki.log/2020/03/index.html">2020/03 (1)</a></li></ul></li><li><input id="tree-label-2019" type="checkbox" class="tree-toggle"><label for="tree-label-2019" class="tree-toggle-button"><svg role="img" class="svg-inline--fa fa-angle-right fa-fw" data-icon="angle-right" data-prefix="fas" viewBox="0 0 320 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"></path></svg><svg role="img" class="svg-inline--fa fa-angle-down fa-fw" data-icon="angle-down" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"></path></svg></label><a href="../../../../../roki.log/2019/index.html">2019 (5)</a><ul class="tree-child"><li><a href="../../../../../roki.log/2019/05/index.html">2019/05 (1)</a></li><li><a href="../../../../../roki.log/2019/03/index.html">2019/03 (2)</a></li><li><a href="../../../../../roki.log/2019/01/index.html">2019/01 (2)</a></li></ul></li><li><input checked id="tree-label-2018" type="checkbox" class="tree-toggle"><label for="tree-label-2018" class="tree-toggle-button"><svg role="img" class="svg-inline--fa fa-angle-right fa-fw" data-icon="angle-right" data-prefix="fas" viewBox="0 0 320 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"></path></svg><svg role="img" class="svg-inline--fa fa-angle-down fa-fw" data-icon="angle-down" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"></path></svg></label><a href="../../../../../roki.log/2018/index.html">2018 (29)</a><ul class="tree-child"><li><a href="../../../../../roki.log/2018/12/index.html">2018/12 (1)</a></li><li><a href="../../../../../roki.log/2018/10/index.html">2018/10 (2)</a></li><li><a href="../../../../../roki.log/2018/09/index.html">2018/09 (3)</a></li><li><a href="../../../../../roki.log/2018/08/index.html">2018/08 (3)</a></li><li><a href="../../../../../roki.log/2018/07/index.html">2018/07 (7)</a></li><li><a href="../../../../../roki.log/2018/06/index.html">2018/06 (5)</a></li><li><a href="../../../../../roki.log/2018/05/index.html">2018/05 (3)</a></li><li><a href="../../../../../roki.log/2018/04/index.html">2018/04 (3)</a></li><li><a href="../../../../../roki.log/2018/03/index.html">2018/03 (2)</a></li></ul></li></ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="content has-text-centered mt-3">
        
        <script crossorigin="anonymous" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5658861742931397"></script><ins style="display:block" data-ad-client="ca-pub-5658861742931397" data-ad-format="autorelaxed" class="adsbygoogle" data-ad-slot="7636558034"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><a href="https://haskell.jp/blog/posts/links.html#roki.dev/roki.log/" target="_blank" rel="nofollow noopener"><img width="234" src="https://haskell.jp/img/supported-by-haskell-jp.svg" class="mt-1" alt="Supported By Haskell-jp."></a>
        
        <div class="content has-text-centered">
    <small>copyright © 2016~ Roki All Rights Reserved.</small>
    <p>Site proudly generated by <a href="http://jaspervdj.be/hakyll" target="_blank" rel="nofollow noopener">Hakyll</a></p>
</div>

    </div>
</footer>


    </body>
</html>
