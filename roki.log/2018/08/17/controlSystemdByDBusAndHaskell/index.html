<!DOCTYPE HTML>
<html lang="ja">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="x-ua-compatible" content="ie=edge" />
        <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
        <meta content="Roki" name="author" />
        
        <meta content="D-Bus とはメッセージバスシステムであり, アプリケーション間で互いにやりとりを行うためのプロセス間通信実装の 1 つである.システムデーモン(新しいハードウェアデバイスの追加やプリンタキューの変更などのイベント等)と,ユーザー単位のログインセッションデーモン(ユーザーアプリケーション間の一般的" name="description" />
        <meta property="og:description" content="D-Bus とはメッセージバスシステムであり, アプリケーション間で互いにやりとりを行うためのプロセス間通信実装の 1 つである.システムデーモン(新しいハードウェアデバイスの追加やプリンタキューの変更などのイベント等)と,ユーザー単位のログインセッションデーモン(ユーザーアプリケーション間の一般的" />
        
        <meta content="Hakyll" name="generator" />
        <meta property="twitter:card" content="summary" />
        <meta property="twitter:site" content="@roki_r7" />
        <meta property="twitter:creator" content="roki_r7" />
        <meta property="og:type" content="website" />
        
        
            <title>Haskell で D-Bus から systemd unit を制御する - roki.dev/roki.log</title>
            <meta property="og:title" content="Haskell で D-Bus から systemd unit を制御する" />
        
        <meta property="og:site_name" content="roki.dev/roki.log" />
        
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP&amp;family=Ubuntu+Mono&amp;display=swap" rel="stylesheet">

        <link rel="stylesheet" href="../../../../../style/roki.log.css" />
        <link rel="shortcut icon" href="../../../../../images/avator/favicon.ico" />
        
        
        
        <script type="text/javascript" src="../../../../../js/components.js"></script>
        <script type="text/javascript">
            addEventNavBar();
            addEventModal();
        </script>
        
        <meta name="google-site-verification" content="13X5cycw11yFEsfZrhsQ0m_cSI90r7HucdErNDQ8Za8" />
        <!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-116653080-2"></script>
		<script>
  		window.dataLayer = window.dataLayer || [];
  		function gtag(){dataLayer.push(arguments);}
  		gtag('js', new Date());
  		gtag('config', 'UA-116653080-2');
		</script>
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5658861742931397" crossorigin="anonymous"></script>
        
        
        
    </head>

    <body>
        <div class="modal" id="modal-about">
            <div class="modal-background"></div>
            <div class="modal-card">
                <header class="modal-card-head">
                    <p class="modal-card-title">
                    <svg role="img" class="svg-inline--fa fa-question fa-fw mr-2" data-icon="question" data-prefix="fas" viewBox="0 0 320 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M80 160c0-35.3 28.7-64 64-64h32c35.3 0 64 28.7 64 64v3.6c0 21.8-11.1 42.1-29.4 53.8l-42.2 27.1c-25.2 16.2-40.4 44.1-40.4 74V320c0 17.7 14.3 32 32 32s32-14.3 32-32v-1.4c0-8.2 4.2-15.8 11-20.2l42.2-27.1c36.6-23.6 58.8-64.1 58.8-107.7V160c0-70.7-57.3-128-128-128H144C73.3 32 16 89.3 16 160c0 17.7 14.3 32 32 32s32-14.3 32-32zm80 320a40 40 0 1 0 0-80 40 40 0 1 0 0 80z"></path></svg>About
                    </p>
                    <button class="delete" aria-label="close"></button>
                </header>
                <section class="modal-card-body">
                    <a href="../../../../../roki.log">roki.log</a><p class="is-inline"> is a blog written about efforts and learning related to technology, mathematics, etc (Most of the content of the article is written in Japanese).</p>
                    <strong>All opinions expressed by Author on this blog is solely 
                    Author’s opinions and do not reflect the opinions of the company to 
                    which I belong.</strong>
                    For more infomation about author Roki, see 
                    <a href="../../../../../index.html">roki.dev</a>.
                </section>
            </div>
        </div>

        <nav class="navbar is-spaced" role="navigation" aria-label="main navigation">
            <div class="navbar-brand">
                <a style="background-color: transparent;" class="navbar-item title pt-5" href="../../../../../roki.log/index.html">
                    roki.log
                </a>
                <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="roki-log-navbar">
                    <span aria-hidden="true"></span>
                    <span aria-hidden="true"></span>
                    <span aria-hidden="true"></span>
                </a>
            </div>
                
            <div id="roki-log-navbar" class="navbar-menu">
                <div class="navbar-end">
                    <a class="navbar-item modal-target" data-target="modal-about">
                        <svg role="img" class="svg-inline--fa fa-question fa-fw mr-2" data-icon="question" data-prefix="fas" viewBox="0 0 320 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M80 160c0-35.3 28.7-64 64-64h32c35.3 0 64 28.7 64 64v3.6c0 21.8-11.1 42.1-29.4 53.8l-42.2 27.1c-25.2 16.2-40.4 44.1-40.4 74V320c0 17.7 14.3 32 32 32s32-14.3 32-32v-1.4c0-8.2 4.2-15.8 11-20.2l42.2-27.1c36.6-23.6 58.8-64.1 58.8-107.7V160c0-70.7-57.3-128-128-128H144C73.3 32 16 89.3 16 160c0 17.7 14.3 32 32 32s32-14.3 32-32zm80 320a40 40 0 1 0 0-80 40 40 0 1 0 0 80z"></path></svg>
                        About
                    </a>
                    <div class="navbar-item has-dropdown is-hoverable">
                        <a class="navbar-link">
                            <svg role="img" class="svg-inline--fa fa-rss mr-2" data-icon="rss" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"></path></svg>
                            Feed
                        </a>
                        <div class="navbar-dropdown">
                            <a class="navbar-item" href="../../../../../roki.log/feed/roki.log.xml">
                                <svg role="img" class="svg-inline--fa fa-rss fa-fw mr-2" data-icon="rss" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"></path></svg>
                                Atom
                            </a>
                            <a class="navbar-item" href="../../../../../roki.log/feed/roki.log-rss.xml">
                                <svg role="img" class="svg-inline--fa fa-rss fa-fw mr-2" data-icon="rss" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"></path></svg>
                                RSS
                            </a>
                            <a class="navbar-item" href="https://feedly.com/i/subscription/feed/https://roki.dev/roki.log/feed/roki.log.xml" target="_blank" rel="nofollow noopener">
                                <svg role="img" class="svg-inline--fa fa-square-rss fa-fw mr-2" data-icon="square-rss" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM96 136c0-13.3 10.7-24 24-24c137 0 248 111 248 248c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-110.5-89.5-200-200-200c-13.3 0-24-10.7-24-24zm0 96c0-13.3 10.7-24 24-24c83.9 0 152 68.1 152 152c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-57.4-46.6-104-104-104c-13.3 0-24-10.7-24-24zm0 120a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"></path></svg>
                                Feedly
                            </a>
                        </div>
                    </div>
                    <div class="navbar-item has-dropdown is-hoverable">
                        <a class="navbar-link">
                            <svg role="img" class="svg-inline--fa fa-info mr-2" data-icon="info" data-prefix="fas" viewBox="0 0 192 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M48 80a48 48 0 1 1 96 0A48 48 0 1 1 48 80zM0 224c0-17.7 14.3-32 32-32H96c17.7 0 32 14.3 32 32V448h32c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H64V256H32c-17.7 0-32-14.3-32-32z"></path></svg>
                            More
                        </a>
                        <div class="navbar-dropdown">
                            <a class="navbar-item" href="../../../../../index.html">
                                <svg role="img" class="svg-inline--fa fa-house fa-fw mr-2" data-icon="house" data-prefix="fas" viewBox="0 0 576 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"></path></svg>
                                roki.dev
                            </a>
                            <hr class="navbar-divider">
                            <a class="navbar-item" href="https://github.com/falgon/roki-web/issues/new/choose" target="_blank" rel="nofollow noopener">
                                <svg role="img" class="svg-inline--fa fa-bug fa-fw mr-2" data-icon="bug" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M256 0c53 0 96 43 96 96v3.6c0 15.7-12.7 28.4-28.4 28.4H188.4c-15.7 0-28.4-12.7-28.4-28.4V96c0-53 43-96 96-96zM41.4 105.4c12.5-12.5 32.8-12.5 45.3 0l64 64c.7 .7 1.3 1.4 1.9 2.1c14.2-7.3 30.4-11.4 47.5-11.4H312c17.1 0 33.2 4.1 47.5 11.4c.6-.7 1.2-1.4 1.9-2.1l64-64c12.5-12.5 32.8-12.5 45.3 0s12.5 32.8 0 45.3l-64 64c-.7 .7-1.4 1.3-2.1 1.9c6.2 12 10.1 25.3 11.1 39.5H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H416c0 24.6-5.5 47.8-15.4 68.6c2.2 1.3 4.2 2.9 6 4.8l64 64c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0l-63.1-63.1c-24.5 21.8-55.8 36.2-90.3 39.6V240c0-8.8-7.2-16-16-16s-16 7.2-16 16V479.2c-34.5-3.4-65.8-17.8-90.3-39.6L86.6 502.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l64-64c1.9-1.9 3.9-3.4 6-4.8C101.5 367.8 96 344.6 96 320H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H96.3c1.1-14.1 5-27.5 11.1-39.5c-.7-.6-1.4-1.2-2.1-1.9l-64-64c-12.5-12.5-12.5-32.8 0-45.3z"></path></svg>
                                Report an issue
                            </a>
                        </div>
                    </div>
                    <div class="navbar-item field">
                        <script async src="https://cse.google.com/cse.js?cx=002573853708615501531:c0ipiy0rxaw">
                        </script>
                        <div class="gcse-searchbox-only"></div>
                    </div>
                </div>
            </div>
        </nav>

        


<main class="section main" role="main">
    <article class="container">
        <div class="card mb-1 is-shadowless">
            <div class="card-content">
                <header>
                    <h2 class="title is-3">
                        <a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/index.html">Haskell で D-Bus から systemd unit を制御する</a>
                    </h2>
                    <ul>
                        <li>
                            <i class="fas fa-calendar-alt fa-fw"></i>
                            2018/08/17 09:00
                        </li>
                        
                            <li>
                                <div class="is-inline-block is-valign-middle">
                                    <svg role="img" class="svg-inline--fa fa-tags fa-fw" data-icon="tags" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M345 39.1L472.8 168.4c52.4 53 52.4 138.2 0 191.2L360.8 472.9c-9.3 9.4-24.5 9.5-33.9 .2s-9.5-24.5-.2-33.9L438.6 325.9c33.9-34.3 33.9-89.4 0-123.7L310.9 72.9c-9.3-9.4-9.2-24.6 .2-33.9s24.6-9.2 33.9 .2zM0 229.5V80C0 53.5 21.5 32 48 32H197.5c17 0 33.3 6.7 45.3 18.7l168 168c25 25 25 65.5 0 90.5L277.3 442.7c-25 25-65.5 25-90.5 0l-168-168C6.7 262.7 0 246.5 0 229.5zM144 144a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"></path></svg>
                                </div>
                                <div class="is-inline-block is-valign-middle">
                                    <div class="tags">
                                        <span class="tag is-dark"><a href="../../../../../roki.log/tags/haskell/index.html"><span>Haskell</span></a></span>
                                    </div>
                                </div>
                            </li>
                        
                    </ul>
                </header>

                
                <div class="content has-text-centered mt-5">
                <script crossorigin="anonymous" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5658861742931397"></script><ins style="display:block" data-full-width-responsive="true" data-ad-client="ca-pub-5658861742931397" data-ad-format="auto" class="adsbygoogle" data-ad-slot="9716211878"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
                </div>
                

                <section class="mt-5 content">
                    
                    <article class="message is-warning">
                        <div class="message-body">
                            <i class="fas fa-info-circle mr-1"></i>
                            この記事は, <a href="https://falgon.github.io/roki.log/" target="_blank" rel="nofollow noopener">旧ブログ</a>から移植された記事です. よって, その内容として, <a href="https://falgon.github.io/roki.log/" target="_blank" rel="nofollow noopener">旧ブログ</a>に依存した文脈が含まれている可能性があります. 予めご了承下さい.
                        </div>
                    </article>
                    
                    <p>D-Bus とはメッセージバスシステムであり, アプリケーション間で互いにやりとりを行うためのプロセス間通信実装の 1 つである. システムデーモン(新しいハードウェアデバイスの追加やプリンタキューの変更などのイベント等)と, ユーザー単位のログインセッションデーモン(ユーザーアプリケーション間の一般的なIPC)を提供する<a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>現代的な Linux カーネルの init プロセスにて起動される systemd デーモンおよびその補助デーモンは, D-Bus にいくつかの API を公開している. 私の観測範囲内において, C や Python, Go 等でこれらを利用する例はそこそこ見たことがあるのだが, Haskell での取り組みは一切見たことがなかったので, 少々これらで遊んで見た日記として本エントリに記す.</p>
<!--more-->
<h2 id="d-bus-api-の確認">D-Bus API の確認</h2>
<p>実行環境は, 次の通りである.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb1-1" aria-hidden="true"></a>$ <span class="fu">uname</span> -a</span>
<span id="cb1-2"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb1-2" aria-hidden="true"></a><span class="ex">Linux</span> vagrant 4.15.0-20-generic #21-Ubuntu SMP Tue Apr 24 06:16:15 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span>
<span id="cb1-3"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb1-3" aria-hidden="true"></a>$ <span class="ex">systemd</span> --version</span>
<span id="cb1-4"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb1-4" aria-hidden="true"></a><span class="ex">systemd</span> 237</span>
<span id="cb1-5"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb1-5" aria-hidden="true"></a><span class="ex">+PAM</span> +AUDIT +SELINUX +IMA +APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ +LZ4 +SECCOMP +BLKID +ELFUTILS +KMOD -IDN2 +IDN -PCRE2 default-hierarchy=hybrid</span></code></pre></div>
<p>D-Bus に公開されている API を利用する際は, とくに高度なラッパーライブラリを用いないような場合においては, <code>dbus-send</code>あるいは<code>gdbus</code>等で全体の構造, インタフェース, メソッドおよびフィールドメンバーを確認するとよい.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb2-1" aria-hidden="true"></a>$ <span class="kw">function</span><span class="fu"> syst()</span><span class="kw">{</span> <span class="va">r=$(</span><span class="ex">gdbus</span> introspect --system --dest org.freedesktop.systemd1 --object-path /org/freedesktop/systemd1<span class="va">)</span>; <span class="bu">echo</span> <span class="va">${r}</span> <span class="kw">|</span> <span class="fu">head</span> -n <span class="va">$1</span> <span class="kw">&amp;&amp;</span> <span class="bu">echo</span> <span class="st">&quot;More than&quot;</span> <span class="va">$(($(</span><span class="bu">echo</span> <span class="va">${r}</span> <span class="kw">|</span> <span class="fu">wc</span> -l<span class="va">)</span> - <span class="va">$1))</span> <span class="st">&quot;lines...&quot;</span><span class="kw">;</span> <span class="kw">}</span></span>
<span id="cb2-2"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb2-2" aria-hidden="true"></a>$ <span class="ex">syst</span> 10</span>
<span id="cb2-3"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb2-3" aria-hidden="true"></a><span class="ex">node</span> /org/freedesktop/systemd1 {</span>
<span id="cb2-4"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb2-4" aria-hidden="true"></a>  <span class="ex">interface</span> org.freedesktop.DBus.Peer {</span>
<span id="cb2-5"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb2-5" aria-hidden="true"></a>    <span class="ex">methods</span>:</span>
<span id="cb2-6"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb2-6" aria-hidden="true"></a>      <span class="fu">Ping()</span>;</span>
<span id="cb2-7"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb2-7" aria-hidden="true"></a>      <span class="ex">GetMachineId</span>(out s machine_uuid);</span>
<span id="cb2-8"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb2-8" aria-hidden="true"></a>    <span class="ex">signals</span>:</span>
<span id="cb2-9"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb2-9" aria-hidden="true"></a>    <span class="ex">properties</span>:</span>
<span id="cb2-10"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb2-10" aria-hidden="true"></a>  };</span>
<span id="cb2-11"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb2-11" aria-hidden="true"></a>  <span class="ex">interface</span> org.freedesktop.DBus.Introspectable {</span>
<span id="cb2-12"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb2-12" aria-hidden="true"></a>    <span class="ex">methods</span>:</span>
<span id="cb2-13"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb2-13" aria-hidden="true"></a><span class="ex">More</span> than 397 lines...</span></code></pre></div>
<p>このインタフェース表記の意味するところに関する詳細は, D-bus 仕様の Type System セクション<a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>に記載されている.</p>
<h2 id="d-bus-の-haskell-バインドの利用">D-Bus の Haskell バインドの利用</h2>
<p><a href="http://hackage.Haskell.org/package/dbus" target="_blank" rel="nofollow noopener">dbus</a> が利用できる. 例えば, 以下に示す<code>StartUnit</code>, <code>StopUnit</code>は,</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb3-1" aria-hidden="true"></a>$ <span class="ex">gdbus</span> introspect --system --dest org.freedesktop.systemd1 --object-path /org/freedesktop/systemd1 <span class="kw">|</span> <span class="fu">grep</span> -e StartUnit -e StopUnit -w -A 2</span>
<span id="cb3-2"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb3-2" aria-hidden="true"></a>      <span class="ex">StartUnit</span>(in  s arg_0,</span>
<span id="cb3-3"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb3-3" aria-hidden="true"></a>                <span class="kw">in</span>  <span class="ex">s</span> arg_1,</span>
<span id="cb3-4"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb3-4" aria-hidden="true"></a>                <span class="ex">out</span> o arg_2);</span>
<span id="cb3-5"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb3-5" aria-hidden="true"></a><span class="ex">--</span></span>
<span id="cb3-6"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb3-6" aria-hidden="true"></a>      <span class="ex">StopUnit</span>(in  s arg_0,</span>
<span id="cb3-7"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb3-7" aria-hidden="true"></a>               <span class="kw">in</span>  <span class="ex">s</span> arg_1,</span>
<span id="cb3-8"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb3-8" aria-hidden="true"></a>               <span class="ex">out</span> o arg_2);</span></code></pre></div>
<p>次のようにして呼び出せる.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb4-1"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-1" aria-hidden="true"></a><span class="ot">{-# LANGUAGE OverloadedStrings #-}</span></span>
<span id="cb4-2"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-2" aria-hidden="true"></a></span>
<span id="cb4-3"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-3" aria-hidden="true"></a><span class="kw">import</span> <span class="dt">DBus</span></span>
<span id="cb4-4"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-4" aria-hidden="true"></a><span class="kw">import</span> <span class="dt">DBus.Client</span></span>
<span id="cb4-5"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-5" aria-hidden="true"></a><span class="kw">import</span> <span class="dt">Data.Int</span> (<span class="dt">Int32</span>)</span>
<span id="cb4-6"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-6" aria-hidden="true"></a></span>
<span id="cb4-7"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-7" aria-hidden="true"></a><span class="kw">type</span> <span class="dt">Unit</span> <span class="ot">=</span> <span class="dt">String</span></span>
<span id="cb4-8"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-8" aria-hidden="true"></a><span class="kw">type</span> <span class="dt">Mode</span> <span class="ot">=</span> <span class="dt">String</span></span>
<span id="cb4-9"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-9" aria-hidden="true"></a><span class="kw">type</span> <span class="dt">SignalNum</span> <span class="ot">=</span> <span class="dt">Int32</span></span>
<span id="cb4-10"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-10" aria-hidden="true"></a></span>
<span id="cb4-11"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-11" aria-hidden="true"></a><span class="ot">systemdObjectPath ::</span> <span class="dt">ObjectPath</span></span>
<span id="cb4-12"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-12" aria-hidden="true"></a>systemdObjectPath <span class="ot">=</span> objectPath_ <span class="st">&quot;/org/freedesktop/systemd1&quot;</span></span>
<span id="cb4-13"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-13" aria-hidden="true"></a></span>
<span id="cb4-14"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-14" aria-hidden="true"></a><span class="ot">systemdInterfaceName ::</span> <span class="dt">InterfaceName</span></span>
<span id="cb4-15"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-15" aria-hidden="true"></a>systemdInterfaceName <span class="ot">=</span> interfaceName_ <span class="st">&quot;org.freedesktop.systemd1.Manager&quot;</span></span>
<span id="cb4-16"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-16" aria-hidden="true"></a></span>
<span id="cb4-17"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-17" aria-hidden="true"></a><span class="ot">systemdDestination ::</span> <span class="dt">BusName</span></span>
<span id="cb4-18"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-18" aria-hidden="true"></a>systemdDestination <span class="ot">=</span> busName_ <span class="st">&quot;org.freedesktop.systemd1&quot;</span></span>
<span id="cb4-19"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-19" aria-hidden="true"></a></span>
<span id="cb4-20"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-20" aria-hidden="true"></a><span class="ot">methodSub ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">MethodCall</span></span>
<span id="cb4-21"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-21" aria-hidden="true"></a>methodSub <span class="ot">=</span> methodCall systemdObjectPath systemdInterfaceName <span class="op">.</span> memberName_</span>
<span id="cb4-22"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-22" aria-hidden="true"></a></span>
<span id="cb4-23"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-23" aria-hidden="true"></a><span class="ot">systemdCall ::</span> <span class="dt">Client</span> <span class="ot">-&gt;</span> <span class="dt">MethodCall</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> [<span class="dt">Variant</span>]</span>
<span id="cb4-24"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-24" aria-hidden="true"></a>systemdCall <span class="ot">=</span> (<span class="op">.</span>) (<span class="fu">fmap</span> methodReturnBody) <span class="op">.</span> call_</span>
<span id="cb4-25"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-25" aria-hidden="true"></a></span>
<span id="cb4-26"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-26" aria-hidden="true"></a><span class="ot">controlUnit ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Client</span> <span class="ot">-&gt;</span> <span class="dt">Unit</span> <span class="ot">-&gt;</span> <span class="dt">Mode</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> [<span class="dt">Variant</span>]</span>
<span id="cb4-27"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-27" aria-hidden="true"></a>controlUnit med cli unit mode <span class="ot">=</span> systemdCall cli (methodSub med) {</span>
<span id="cb4-28"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-28" aria-hidden="true"></a>    methodCallDestination <span class="ot">=</span> <span class="dt">Just</span> systemdDestination,</span>
<span id="cb4-29"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-29" aria-hidden="true"></a>    methodCallBody <span class="ot">=</span> <span class="fu">map</span> toVariant [unit, mode]</span>
<span id="cb4-30"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-30" aria-hidden="true"></a>}</span>
<span id="cb4-31"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-31" aria-hidden="true"></a></span>
<span id="cb4-32"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-32" aria-hidden="true"></a><span class="ot">startUnit ::</span> <span class="dt">Client</span> <span class="ot">-&gt;</span> <span class="dt">Unit</span> <span class="ot">-&gt;</span> <span class="dt">Mode</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> [<span class="dt">Variant</span>]</span>
<span id="cb4-33"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-33" aria-hidden="true"></a>startUnit <span class="ot">=</span> controlUnit <span class="st">&quot;StartUnit&quot;</span></span>
<span id="cb4-34"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-34" aria-hidden="true"></a></span>
<span id="cb4-35"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-35" aria-hidden="true"></a><span class="ot">stopUnit ::</span> <span class="dt">Client</span> <span class="ot">-&gt;</span> <span class="dt">Unit</span> <span class="ot">-&gt;</span> <span class="dt">Mode</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> [<span class="dt">Variant</span>]</span>
<span id="cb4-36"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb4-36" aria-hidden="true"></a>stopUnit <span class="ot">=</span> controlUnit <span class="st">&quot;StopUnit&quot;</span></span></code></pre></div>
<p>以下に示す<code>ListUnitsByNames</code><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>は,</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb5-1" aria-hidden="true"></a>$ <span class="ex">gdbus</span> introspect --system --dest org.freedesktop.systemd1 --object-path /org/freedesktop/systemd1 <span class="kw">|</span> <span class="fu">grep</span> ListUnitsByNames -w -A 1</span>
<span id="cb5-2"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb5-2" aria-hidden="true"></a>      <span class="ex">ListUnitsByNames</span>(in  as arg_0,</span>
<span id="cb5-3"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb5-3" aria-hidden="true"></a>                       <span class="ex">out</span> a(ssssssouso) <span class="ex">arg_1</span>);</span></code></pre></div>
<p>次のようにして呼び出せる.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb6-1"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb6-1" aria-hidden="true"></a><span class="ot">listUnitsByNames ::</span> <span class="dt">IsValue</span> a <span class="ot">=&gt;</span> <span class="dt">Client</span> <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> <span class="dt">IO</span> [<span class="dt">Variant</span>]</span>
<span id="cb6-2"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb6-2" aria-hidden="true"></a>listUnitsByNames cli var <span class="ot">=</span> systemdCall cli (methodSub <span class="st">&quot;ListUnitsByNames&quot;</span>) {</span>
<span id="cb6-3"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb6-3" aria-hidden="true"></a>    methodCallDestination <span class="ot">=</span> <span class="dt">Just</span> systemdDestination,</span>
<span id="cb6-4"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb6-4" aria-hidden="true"></a>    methodCallBody <span class="ot">=</span> [toVariant var]</span>
<span id="cb6-5"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb6-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>動作確認のためのユニットを適当に置いておく<a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb7-1"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb7-1" aria-hidden="true"></a>$ <span class="fu">mkdir</span> -p /opt/writehello/bin</span>
<span id="cb7-2"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb7-2" aria-hidden="true"></a>$ <span class="fu">sudo</span> sh -c <span class="st">&quot;echo </span><span class="dt">\&quot;</span><span class="st">#\!/bin/bash\nwhile :\ndo\n\tsleep 3\n\techo </span><span class="dt">\&quot;</span><span class="st">hello</span><span class="dt">\&quot;</span><span class="st">\ndone</span><span class="dt">\&quot;</span><span class="st">&quot;</span> <span class="op">&gt;</span> writehello.sh</span>
<span id="cb7-3"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb7-3" aria-hidden="true"></a>$ <span class="fu">sudo</span> chmod +x /opt/writehello/bin/writehello.sh</span>
<span id="cb7-4"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb7-4" aria-hidden="true"></a>$ <span class="fu">sudo</span> sh -c <span class="st">&quot;echo </span><span class="dt">\&quot;</span><span class="st">[Unit]\nDescription = hello daemon\nConditionPathExists = /opt/writehello/bin/writehello.sh\n\n[Service]\nExecStart = /opt/writehello/bin/writehello.sh\nRestart = always\nType = simple\n\n[Install]\nWantedBy = multi-user.target</span><span class="dt">\&quot;</span><span class="st">&quot;</span> <span class="op">&gt;</span> /etc/systemd/system/writehello.service</span>
<span id="cb7-5"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb7-5" aria-hidden="true"></a>$ <span class="fu">sudo</span> chmod -x /etc/systemd/system/writehello.service</span>
<span id="cb7-6"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb7-6" aria-hidden="true"></a>$ <span class="fu">sudo</span> chmod o-w /etc/systemd/system/writehello.service</span>
<span id="cb7-7"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb7-7" aria-hidden="true"></a>$ <span class="fu">sudo</span> systemd-analyze verify /etc/systemd/system/writehello.service</span>
<span id="cb7-8"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb7-8" aria-hidden="true"></a><span class="ex">Attempted</span> to remove disk file system, and we can<span class="st">&#39;t allow that.</span></span>
<span id="cb7-9"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb7-9" aria-hidden="true"></a><span class="st">$ sudo systemctl daemon-reload</span></span>
<span id="cb7-10"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb7-10" aria-hidden="true"></a><span class="st">$ sudo systemctl start writehello.service &amp;&amp; journalctl -f -u writehello.service &amp; sleep 10 &amp;&amp; sudo kill $! &amp;&amp; sudo systemctl stop writehello.service</span></span>
<span id="cb7-11"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb7-11" aria-hidden="true"></a><span class="st">[1] 2001</span></span>
<span id="cb7-12"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb7-12" aria-hidden="true"></a><span class="st">-- Logs begin at Fri 2018-08-17 16:19:05 UTC. --</span></span>
<span id="cb7-13"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb7-13" aria-hidden="true"></a><span class="st">Aug 17 16:19:13 vagrant systemd[1]: Started hello daemon.</span></span>
<span id="cb7-14"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb7-14" aria-hidden="true"></a><span class="st">Aug 17 16:19:16 vagrant writehello.sh[1989]: hello</span></span>
<span id="cb7-15"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb7-15" aria-hidden="true"></a><span class="st">Aug 17 16:19:19 vagrant writehello.sh[1989]: hello</span></span>
<span id="cb7-16"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb7-16" aria-hidden="true"></a><span class="st">Aug 17 16:19:22 vagrant writehello.sh[1989]: hello</span></span></code></pre></div>
<p>先の関数らから writehello.service ユニットを制御する.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb8-1"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb8-1" aria-hidden="true"></a><span class="kw">module</span> <span class="dt">Main</span> <span class="kw">where</span></span>
<span id="cb8-2"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb8-2" aria-hidden="true"></a></span>
<span id="cb8-3"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb8-3" aria-hidden="true"></a><span class="kw">import</span> <span class="dt">DBus.Client</span> (connectSystem)</span>
<span id="cb8-4"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb8-4" aria-hidden="true"></a><span class="kw">import</span> <span class="dt">System.Environment</span> (getArgs)</span>
<span id="cb8-5"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb8-5" aria-hidden="true"></a><span class="kw">import</span> <span class="dt">Control.Monad</span> (mapM_, (&lt;=&lt;))</span>
<span id="cb8-6"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb8-6" aria-hidden="true"></a></span>
<span id="cb8-7"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb8-7" aria-hidden="true"></a><span class="ot">main ::</span> <span class="dt">IO</span> ()</span>
<span id="cb8-8"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb8-8" aria-hidden="true"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb8-9"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb8-9" aria-hidden="true"></a>    client <span class="ot">&lt;-</span> connectSystem</span>
<span id="cb8-10"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb8-10" aria-hidden="true"></a>    args <span class="ot">&lt;-</span> getArgs</span>
<span id="cb8-11"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb8-11" aria-hidden="true"></a>    <span class="fu">mapM_</span> (<span class="fu">print</span> <span class="op">&lt;=&lt;</span> <span class="fu">flip</span> (startUnit client) <span class="st">&quot;replace&quot;</span>) args</span>
<span id="cb8-12"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb8-12" aria-hidden="true"></a>    <span class="fu">print</span> <span class="op">=&lt;&lt;</span> listUnitsByNames client args</span></code></pre></div>
<p>引数に writehello.service を指定してスーパーユーザで実行すると, 次のような出力が得られる.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb9-1"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb9-1" aria-hidden="true"></a>[<span class="ex">Variant</span> (ObjectPath <span class="st">&quot;/org/freedesktop/systemd1/job/1053&quot;</span>)]</span>
<span id="cb9-2"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb9-2" aria-hidden="true"></a>[<span class="ex">Variant</span> [(<span class="st">&quot;writehello.service&quot;</span>, <span class="st">&quot;hello daemon&quot;</span>, <span class="st">&quot;loaded&quot;</span>, <span class="st">&quot;active&quot;</span>, <span class="st">&quot;running&quot;</span>, <span class="st">&quot;&quot;</span>, ObjectPath <span class="st">&quot;/org/freedesktop/systemd1/unit/writehello_2eservice&quot;</span>, 0, <span class="st">&quot;&quot;</span>, ObjectPath <span class="st">&quot;/&quot;</span>)]]</span></code></pre></div>
<p>停止も忘れずに.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb10-1"><a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#cb10-1" aria-hidden="true"></a><span class="fu">mapM_</span> (<span class="fu">print</span> <span class="op">&lt;=&lt;</span> <span class="fu">flip</span> (stopUnit client) <span class="st">&quot;replace&quot;</span>) args </span></code></pre></div>
<p>なお, 本エントリにおける一連の実装とその他の systemd D-Bus API を利用したいくつかの snippets を下記リポジトリにて管理している.</p>
<div class="box has-text-centered is-shadowless">
<p><svg role="img" class="svg-inline--fa fa-github mr-2" data-icon="github" data-prefix="fab" viewBox="0 0 496 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> <a href="https://bitbucket.org/r0ki/systemdplhs/src/master/" target="_blank" rel="nofollow noopener">r0ki/systemdplhs - Snippets collection that controls systemd from D-Bus with Haskell.</a></p>
</div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>説明は<a href="https://www.freedesktop.org/wiki/Software/dbus/#index1h1" target="_blank" rel="nofollow noopener">公式ページ</a>から.<a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>“D-Bus Specification”, <a href="https://dbus.freedesktop.org/doc/dbus-specification.html#type-system" class="uri" target="_blank" rel="nofollow noopener">https://dbus.freedesktop.org/doc/dbus-specification.html#type-system</a> 2018 年 8 月 17 日アクセス.<a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>Note: <code>ListUnitsByName</code> は systemd v230 以上を要する.<a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p><code>systemd-analyze verify</code>の結果で, <code>Attempted to remove disk file system, and we can&#39;t allow that.</code>というメッセージが出力されているが, これは systemd 237-4 および 238 でのバグ(<a href="https://github.com/systemd/systemd/issues/8592" target="_blank" rel="nofollow noopener">#8592</a>)との報告がある.<a href="../../../../../roki.log/2018/08/17/controlSystemdByDBusAndHaskell/#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
                </section>
                <hr class="hr" />
                <div class="is-pulled-right">
    <style>
    .social-icon a {
        color: #363636;
    }
    </style>
    <ul class="fa-ul">
        <li class="fa-li is-inline social-icon">
            <a href="http://twitter.com/share?url=https://roki.dev/roki.log/2018/08/17/controlSystemdByDBusAndHaskell/index.html&amp;text=Haskell で D-Bus から systemd unit を制御する%20%7C%20roki.dev%2Froki.log&amp;via=530506" rel="nofollow noopener noreferrer" class="social-icon-twitter" target="_blank" rel="nofollow noopener">
                <svg role="img" class="svg-inline--fa fa-square-x-twitter fa-lg" data-icon="square-x-twitter" data-prefix="fab" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm297.1 84L257.3 234.6 379.4 396H283.8L209 298.1 123.3 396H75.8l111-126.9L69.7 116h98l67.7 89.5L313.6 116h47.5zM323.3 367.6L153.4 142.9H125.1L296.9 367.6h26.3z"></path></svg>
            </a>
        </li>
        <li class="fa-li is-inline social-icon">
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://roki.dev/roki.log/2018/08/17/controlSystemdByDBusAndHaskell/index.html" rel="nofollow noopener noreferrer" class="social-icon-facebook" target="_blank" rel="nofollow noopener">
                <svg role="img" class="svg-inline--fa fa-square-facebook fa-lg" data-icon="square-facebook" data-prefix="fab" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64h98.2V334.2H109.4V256h52.8V222.3c0-87.1 39.4-127.5 125-127.5c16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1c-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H255V480H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64z"></path></svg>
            </a>
        </li>
        <li class="fa-li is-inline social-icon">
            <a href="https://social-plugins.line.me/lineit/share?url=https://roki.dev/roki.log/2018/08/17/controlSystemdByDBusAndHaskell/index.html" rel="nofollow noopener noreferrer" class="social-icon-line" target="_blank" rel="nofollow noopener">
                <svg role="img" class="svg-inline--fa fa-line fa-lg" data-icon="line" data-prefix="fab" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M311 196.8v81.3c0 2.1-1.6 3.7-3.7 3.7h-13c-1.3 0-2.4-.7-3-1.5l-37.3-50.3v48.2c0 2.1-1.6 3.7-3.7 3.7h-13c-2.1 0-3.7-1.6-3.7-3.7V196.9c0-2.1 1.6-3.7 3.7-3.7h12.9c1.1 0 2.4 .6 3 1.6l37.3 50.3V196.9c0-2.1 1.6-3.7 3.7-3.7h13c2.1-.1 3.8 1.6 3.8 3.5zm-93.7-3.7h-13c-2.1 0-3.7 1.6-3.7 3.7v81.3c0 2.1 1.6 3.7 3.7 3.7h13c2.1 0 3.7-1.6 3.7-3.7V196.8c0-1.9-1.6-3.7-3.7-3.7zm-31.4 68.1H150.3V196.8c0-2.1-1.6-3.7-3.7-3.7h-13c-2.1 0-3.7 1.6-3.7 3.7v81.3c0 1 .3 1.8 1 2.5c.7 .6 1.5 1 2.5 1h52.2c2.1 0 3.7-1.6 3.7-3.7v-13c0-1.9-1.6-3.7-3.5-3.7zm193.7-68.1H327.3c-1.9 0-3.7 1.6-3.7 3.7v81.3c0 1.9 1.6 3.7 3.7 3.7h52.2c2.1 0 3.7-1.6 3.7-3.7V265c0-2.1-1.6-3.7-3.7-3.7H344V247.7h35.5c2.1 0 3.7-1.6 3.7-3.7V230.9c0-2.1-1.6-3.7-3.7-3.7H344V213.5h35.5c2.1 0 3.7-1.6 3.7-3.7v-13c-.1-1.9-1.7-3.7-3.7-3.7zM512 93.4V419.4c-.1 51.2-42.1 92.7-93.4 92.6H92.6C41.4 511.9-.1 469.8 0 418.6V92.6C.1 41.4 42.2-.1 93.4 0H419.4c51.2 .1 92.7 42.1 92.6 93.4zM441.6 233.5c0-83.4-83.7-151.3-186.4-151.3s-186.4 67.9-186.4 151.3c0 74.7 66.3 137.4 155.9 149.3c21.8 4.7 19.3 12.7 14.4 42.1c-.8 4.7-3.8 18.4 16.1 10.1s107.3-63.2 146.5-108.2c27-29.7 39.9-59.8 39.9-93.1z"></path></svg>
            </a>
        </li>
        <li class="fa-li is-inline social-icon">
            <a href="https://getpocket.com/edit?url=https://roki.dev/roki.log/2018/08/17/controlSystemdByDBusAndHaskell/index.html" rel="nofollow noopener noreferrer" class="social-icon-pocket" target="_blank" rel="nofollow noopener">
                <svg role="img" class="svg-inline--fa fa-get-pocket fa-lg" data-icon="get-pocket" data-prefix="fab" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M407.6 64h-367C18.5 64 0 82.5 0 104.6v135.2C0 364.5 99.7 464 224.2 464c124 0 223.8-99.5 223.8-224.2V104.6c0-22.4-17.7-40.6-40.4-40.6zm-162 268.5c-12.4 11.8-31.4 11.1-42.4 0C89.5 223.6 88.3 227.4 88.3 209.3c0-16.9 13.8-30.7 30.7-30.7 17 0 16.1 3.8 105.2 89.3 90.6-86.9 88.6-89.3 105.5-89.3 16.9 0 30.7 13.8 30.7 30.7 0 17.8-2.9 15.7-114.8 123.2z"></path></svg>
            </a>
        </li>
    </ul>
</div>
<div style="is-clear-fix"></div>

                <br />

                <aside class="comments mt-4">
                    <div id="disqus_thread"></div>
                    <script>
                    (function() { 
                        var d = document, s = d.createElement('script');
                        s.src = 'https://roki-log.disqus.com/embed.js';
                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s); 
                    })();
                    </script>
                    <noscript>
                        Please enable JavaScript to view the 
                        <a href="https://roki-log.disqus.com/?ref_noscript" target="_blank" rel="nofollow noopener">
                            comments powered by Disqus.
                        </a>
                    </noscript>
                </aside>

                <div class="container">
                    <div class="card mb-1 is-shadowless" style="background-color: transparent;">
                        <div class="card-content">
                            <nav class="pagination is-centered" role="navigation" aria-label="pagination">
                                
				                <a href="../../../../../roki.log/2018/09/6/The_definition_of_Trigonometric_function/index.html" class="pagination-previous">
                                    <div class="is-inline-block is-valign-middle">
                                        <svg role="img" class="svg-inline--fa fa-angles-left mr-1" data-icon="angles-left" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"></path></svg>
                                    </div>
                                    <div class="is-inline-block is-valign-middle">
                                        <i class="fas fa-calendar-alt mr-1"></i>2018/09/06 00:00:00
                                        <svg role="img" class="svg-inline--fa fa-pencil ml-1 mr-1" data-icon="pencil" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path></svg>三角関数の公...
                                    </div>
                                </a>
                                

                                
				                <a href="../../../../../roki.log/2018/08/15/aws_ec2_distcc/index.html" class="pagination-next">
                                    <div class="is-inline-block is-valign-middle">
                                        <i class="fas fa-calendar-alt mr-1"></i>2018/08/15 00:00:00
                                        <svg role="img" class="svg-inline--fa fa-pencil ml-1 mr-1" data-icon="pencil" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path></svg>AWS EC...
                                    </div>
                                    <div class="ml-1 is-inline-block is-valign-middle">
                                        <svg role="img" class="svg-inline--fa fa-angles-right" data-icon="angles-right" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M470.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 256 265.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160zm-352 160l160-160c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L210.7 256 73.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0z"></path></svg>
                                    </div>
                                </a>
                                
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </article>
</main>
<footer class="footer">
    <div class="container" style="display: flex; justify-content: center; align-items: center;">
    <figure class="image">
        <img class="footer-dec" />
    </figure>
</div>

    <div class="container mt-3">
        <div class="columns is-multiline">
            <div class="column is-one-quarter">
                <h4 class="title is-5">
                    <svg role="img" class="svg-inline--fa fa-user" data-icon="user" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"></path></svg>
                    About Me
                </h4>
                <figure class="image is-64x64 is-inline-block is-valign-middle" style="align: center;">
                    <picture>
                        <source type="image/webp" class="blured-my-prof-webp" srcset="../../../../../images/avator/prof1000x1000.png.webp"></source>
                        <img class="blured-my-prof is-inline-block mt-0 is-valign-middle" />
                    </picture>
                </figure>
                <div class="is-inline-block is-valign-middle">
                    <h5 class="title is-6 mb-0">
                        <svg role="img" class="svg-inline--fa fa-signature fa-fw" data-icon="signature" data-prefix="fas" viewBox="0 0 640 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M192 128c0-17.7 14.3-32 32-32s32 14.3 32 32v7.8c0 27.7-2.4 55.3-7.1 82.5l-84.4 25.3c-40.6 12.2-68.4 49.6-68.4 92v71.9c0 40 32.5 72.5 72.5 72.5c26 0 50-13.9 62.9-36.5l13.9-24.3c26.8-47 46.5-97.7 58.4-150.5l94.4-28.3-12.5 37.5c-3.3 9.8-1.6 20.5 4.4 28.8s15.7 13.3 26 13.3H544c17.7 0 32-14.3 32-32s-14.3-32-32-32H460.4l18-53.9c3.8-11.3 .9-23.8-7.4-32.4s-20.7-11.8-32.2-8.4L316.4 198.1c2.4-20.7 3.6-41.4 3.6-62.3V128c0-53-43-96-96-96s-96 43-96 96v32c0 17.7 14.3 32 32 32s32-14.3 32-32V128zm-9.2 177l49-14.7c-10.4 33.8-24.5 66.4-42.1 97.2l-13.9 24.3c-1.5 2.6-4.3 4.3-7.4 4.3c-4.7 0-8.5-3.8-8.5-8.5V335.6c0-14.1 9.3-26.6 22.8-30.7zM24 368c-13.3 0-24 10.7-24 24s10.7 24 24 24H64.3c-.2-2.8-.3-5.6-.3-8.5V368H24zm592 48c13.3 0 24-10.7 24-24s-10.7-24-24-24H305.9c-6.7 16.3-14.2 32.3-22.3 48H616z"></path></svg>
                        Roki
                    </h5>
                    <i class="fas fa-question-circle fa-fw"></i>
                    <a href="../../../../../">
                        more info
                    </a>
                </div>
            </div>
            
            <div class="column is-one-quarter">
                <h4 class="title is-5">
                    <svg role="img" class="svg-inline--fa fa-file" data-icon="file" data-prefix="fas" viewBox="0 0 384 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M0 64C0 28.7 28.7 0 64 0H224V128c0 17.7 14.3 32 32 32H384V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V64zm384 64H256V0L384 128z"></path></svg>
                    Recent posts
                </h4>
                <ul>
                    
                    <li>
                        <svg role="img" class="svg-inline--fa fa-pencil" data-icon="pencil" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path></svg>
                        <a href="../../../../../roki.log/2023/12/06/add-new-web-api-send-plain-text/index.html">東京ガスの請求通知を自作 LINE Bot に喋らせる</a>
                    </li>
                    
                    <li>
                        <svg role="img" class="svg-inline--fa fa-pencil" data-icon="pencil" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path></svg>
                        <a href="../../../../../roki.log/2022/04/10/LineBotDevelopment/index.html">簡易認証, 指定時間実行可能な LINE Bot の自作</a>
                    </li>
                    
                    <li>
                        <svg role="img" class="svg-inline--fa fa-pencil" data-icon="pencil" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path></svg>
                        <a href="../../../../../roki.log/2021/07/10/SelfMadeTinyGit/index.html">技術書典 11 にて Git (一部) を自作する記事を執筆した</a>
                    </li>
                    
                    <li>
                        <svg role="img" class="svg-inline--fa fa-pencil" data-icon="pencil" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path></svg>
                        <a href="../../../../../roki.log/2020/12/16/CompileTimeLazyKWithCXXTemplateMetaProgramming/index.html">C++ テンプレートメタプログラミングによるコンパイル時 Lazy K インタプリタ</a>
                    </li>
                    
                    <li>
                        <svg role="img" class="svg-inline--fa fa-pencil" data-icon="pencil" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path></svg>
                        <a href="../../../../../roki.log/2020/08/25/hello-roki-web/index.html">個人ページ, ブログを移行した</a>
                    </li>
                    
                </ul>
            </div>

            <div class="column is-one-quarter">
                <h4 class="title is-5">
                    <svg role="img" class="svg-inline--fa fa-tags" data-icon="tags" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M345 39.1L472.8 168.4c52.4 53 52.4 138.2 0 191.2L360.8 472.9c-9.3 9.4-24.5 9.5-33.9 .2s-9.5-24.5-.2-33.9L438.6 325.9c33.9-34.3 33.9-89.4 0-123.7L310.9 72.9c-9.3-9.4-9.2-24.6 .2-33.9s24.6-9.2 33.9 .2zM0 229.5V80C0 53.5 21.5 32 48 32H197.5c17 0 33.3 6.7 45.3 18.7l168 168c25 25 25 65.5 0 90.5L277.3 442.7c-25 25-65.5 25-90.5 0l-168-168C6.7 262.7 0 246.5 0 229.5zM144 144a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"></path></svg>
                    Categories
                </h4>
                <div class="tags"><span class="tag is-dark"><a href="../../../../../roki.log/tags/aws/index.html"><span>AWS</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/bot/index.html"><span>Bot</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/c/index.html"><span>C++</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/compiler/index.html"><span>Compiler</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/elementary-number-theory/index.html"><span>Elementary number theory</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/git/index.html"><span>Git</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/googleappsscript/index.html"><span>GoogleAppsScript</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/group-theory/index.html"><span>Group theory</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/haskell/index.html"><span>Haskell</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/line/index.html"><span>LINE</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/lazy-k/index.html"><span>Lazy K</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/network/index.html"><span>Network</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/networking/index.html"><span>Networking</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/probability-theory/index.html"><span>Probability theory</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/python/index.html"><span>Python</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/quantum-mechanics/index.html"><span>Quantum mechanics</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/security/index.html"><span>Security</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/emscripten/index.html"><span>emscripten</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/golang/index.html"><span>golang</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/javascript/index.html"><span>javascript</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/math/index.html"><span>math</span></a></span><span class="tag is-dark"><a href="../../../../../roki.log/tags/physics/index.html"><span>physics</span></a></span></div>
            </div>

            <div class="column">
                <h4 class="title is-5">
                    <svg role="img" class="svg-inline--fa fa-box-archive" data-icon="box-archive" data-prefix="fas" viewBox="0 0 512 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M32 32H480c17.7 0 32 14.3 32 32V96c0 17.7-14.3 32-32 32H32C14.3 128 0 113.7 0 96V64C0 46.3 14.3 32 32 32zm0 128H480V416c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V160zm128 80c0 8.8 7.2 16 16 16H336c8.8 0 16-7.2 16-16s-7.2-16-16-16H176c-8.8 0-16 7.2-16 16z"></path></svg>
                    Archive
                </h4>
                <div class="archives">
                <ul class="archive-tree"><li><input id="tree-label-2023" type="checkbox" class="tree-toggle"><label for="tree-label-2023" class="tree-toggle-button"><svg role="img" class="svg-inline--fa fa-angle-right fa-fw" data-icon="angle-right" data-prefix="fas" viewBox="0 0 320 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"></path></svg><svg role="img" class="svg-inline--fa fa-angle-down fa-fw" data-icon="angle-down" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"></path></svg></label><a href="../../../../../roki.log/2023/index.html">2023 (1)</a><ul class="tree-child"><li><a href="../../../../../roki.log/2023/12/index.html">2023/12 (1)</a></li></ul></li><li><input id="tree-label-2022" type="checkbox" class="tree-toggle"><label for="tree-label-2022" class="tree-toggle-button"><svg role="img" class="svg-inline--fa fa-angle-right fa-fw" data-icon="angle-right" data-prefix="fas" viewBox="0 0 320 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"></path></svg><svg role="img" class="svg-inline--fa fa-angle-down fa-fw" data-icon="angle-down" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"></path></svg></label><a href="../../../../../roki.log/2022/index.html">2022 (1)</a><ul class="tree-child"><li><a href="../../../../../roki.log/2022/04/index.html">2022/04 (1)</a></li></ul></li><li><input id="tree-label-2021" type="checkbox" class="tree-toggle"><label for="tree-label-2021" class="tree-toggle-button"><svg role="img" class="svg-inline--fa fa-angle-right fa-fw" data-icon="angle-right" data-prefix="fas" viewBox="0 0 320 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"></path></svg><svg role="img" class="svg-inline--fa fa-angle-down fa-fw" data-icon="angle-down" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"></path></svg></label><a href="../../../../../roki.log/2021/index.html">2021 (1)</a><ul class="tree-child"><li><a href="../../../../../roki.log/2021/07/index.html">2021/07 (1)</a></li></ul></li><li><input id="tree-label-2020" type="checkbox" class="tree-toggle"><label for="tree-label-2020" class="tree-toggle-button"><svg role="img" class="svg-inline--fa fa-angle-right fa-fw" data-icon="angle-right" data-prefix="fas" viewBox="0 0 320 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"></path></svg><svg role="img" class="svg-inline--fa fa-angle-down fa-fw" data-icon="angle-down" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"></path></svg></label><a href="../../../../../roki.log/2020/index.html">2020 (3)</a><ul class="tree-child"><li><a href="../../../../../roki.log/2020/12/index.html">2020/12 (1)</a></li><li><a href="../../../../../roki.log/2020/08/index.html">2020/08 (1)</a></li><li><a href="../../../../../roki.log/2020/03/index.html">2020/03 (1)</a></li></ul></li><li><input id="tree-label-2019" type="checkbox" class="tree-toggle"><label for="tree-label-2019" class="tree-toggle-button"><svg role="img" class="svg-inline--fa fa-angle-right fa-fw" data-icon="angle-right" data-prefix="fas" viewBox="0 0 320 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"></path></svg><svg role="img" class="svg-inline--fa fa-angle-down fa-fw" data-icon="angle-down" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"></path></svg></label><a href="../../../../../roki.log/2019/index.html">2019 (5)</a><ul class="tree-child"><li><a href="../../../../../roki.log/2019/05/index.html">2019/05 (1)</a></li><li><a href="../../../../../roki.log/2019/03/index.html">2019/03 (2)</a></li><li><a href="../../../../../roki.log/2019/01/index.html">2019/01 (2)</a></li></ul></li><li><input checked id="tree-label-2018" type="checkbox" class="tree-toggle"><label for="tree-label-2018" class="tree-toggle-button"><svg role="img" class="svg-inline--fa fa-angle-right fa-fw" data-icon="angle-right" data-prefix="fas" viewBox="0 0 320 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"></path></svg><svg role="img" class="svg-inline--fa fa-angle-down fa-fw" data-icon="angle-down" data-prefix="fas" viewBox="0 0 448 512" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill="currentColor" d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"></path></svg></label><a href="../../../../../roki.log/2018/index.html">2018 (29)</a><ul class="tree-child"><li><a href="../../../../../roki.log/2018/12/index.html">2018/12 (1)</a></li><li><a href="../../../../../roki.log/2018/10/index.html">2018/10 (2)</a></li><li><a href="../../../../../roki.log/2018/09/index.html">2018/09 (3)</a></li><li><a href="../../../../../roki.log/2018/08/index.html">2018/08 (3)</a></li><li><a href="../../../../../roki.log/2018/07/index.html">2018/07 (7)</a></li><li><a href="../../../../../roki.log/2018/06/index.html">2018/06 (5)</a></li><li><a href="../../../../../roki.log/2018/05/index.html">2018/05 (3)</a></li><li><a href="../../../../../roki.log/2018/04/index.html">2018/04 (3)</a></li><li><a href="../../../../../roki.log/2018/03/index.html">2018/03 (2)</a></li></ul></li></ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="content has-text-centered mt-3">
        
        <script crossorigin="anonymous" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5658861742931397"></script><ins style="display:block" data-ad-client="ca-pub-5658861742931397" data-ad-format="autorelaxed" class="adsbygoogle" data-ad-slot="7636558034"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><a href="https://haskell.jp/blog/posts/links.html#roki.dev/roki.log/" target="_blank" rel="nofollow noopener"><img width="234" src="https://haskell.jp/img/supported-by-haskell-jp.svg" class="mt-1" alt="Supported By Haskell-jp."></a>
        
        <div class="content has-text-centered">
    <small>copyright © 2016~ Roki All Rights Reserved.</small>
    <p>Site proudly generated by <a href="http://jaspervdj.be/hakyll" target="_blank" rel="nofollow noopener">Hakyll</a></p>
</div>

    </div>
</footer>


    </body>
</html>
