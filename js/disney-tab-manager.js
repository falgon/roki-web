export class DisneyTabManager{constructor(t){const e=document.querySelector(t);if(!e)throw new Error(`Tab list not found: ${t}`);this.tabs=Array.from(e.querySelectorAll('[role="tab"]')),this.panels=[],this.tabs.forEach(t=>{const e=t.getAttribute("aria-controls");if(e){const t=document.getElementById(e);t&&this.panels.push(t)}}),this.initCallbacks=new Map,this.initializedPanels=new Set,this.hashToPanelMap=new Map([["exp_list","panel-list"],["exp_timeline","panel-timeline"],["exp_tags","panel-tags"],["exp_hotels","panel-hotels"]]),this.setupEventListeners()}registerInitCallback(t,e){this.initCallbacks.set(t,e)}initialize(){this.initializeActiveTab()}setupEventListeners(){this.tabs.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault(),this.switchToTab(t)}),t.addEventListener("keydown",e=>{this.handleKeyDown(e,t)})})}activateTabFromHash(){const t=window.location.hash.substring(1);if(!t)return!1;const e=this.hashToPanelMap.get(t);if(!e)return!1;const i=this.tabs.find(t=>t.getAttribute("aria-controls")===e);return!!i&&(this.switchToTab(i),!0)}initializeActiveTab(){if(this.activateTabFromHash())return;const t=this.tabs.find(t=>"true"===t.getAttribute("aria-selected"));if(t){const e=t.getAttribute("aria-controls");e&&this.initializePanelIfNeeded(e)}}switchToTab(t){this.tabs.forEach(t=>{t.setAttribute("aria-selected","false"),t.setAttribute("tabindex","-1"),t.parentElement?.classList.remove("is-active")}),t.setAttribute("aria-selected","true"),t.setAttribute("tabindex","0"),t.parentElement?.classList.add("is-active"),t.focus(),this.panels.forEach(t=>{t.classList.remove("is-active"),t.setAttribute("hidden","")});const e=t.getAttribute("aria-controls");if(e){const t=document.getElementById(e);t&&(t.classList.add("is-active"),t.removeAttribute("hidden"),this.initializePanelIfNeeded(e));const i=Array.from(this.hashToPanelMap.entries()).find(([t,i])=>i===e)?.[0];i&&history.replaceState(null,"",`#${i}`)}}handleKeyDown(t,e){const i=this.tabs.indexOf(e);let s=null;switch(t.key){case"ArrowLeft":s=i>0?i-1:this.tabs.length-1,t.preventDefault();break;case"ArrowRight":s=i<this.tabs.length-1?i+1:0,t.preventDefault();break;case"Home":s=0,t.preventDefault();break;case"End":s=this.tabs.length-1,t.preventDefault();break;case"Enter":case" ":this.switchToTab(e),t.preventDefault()}null!==s&&this.switchToTab(this.tabs[s])}initializePanelIfNeeded(t){if(this.initializedPanels.has(t))return;const e=this.initCallbacks.get(t);e&&(e(),this.initializedPanels.add(t))}}
